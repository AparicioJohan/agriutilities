<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="agriutilities">
<title>Repeated Measurements • agriutilities</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Repeated Measurements">
<meta property="og:description" content="agriutilities">
<meta property="og:image" content="https://apariciojohan.github.io/agriutilities/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-secondary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">agriutilities</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
    Home
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa-code"></span>
     
    Reference
  </a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--articles">
    <span class="fa fa-book"></span>
     
    Articles
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--articles">
    <a class="dropdown-item" href="../articles/how-to-start.html">How to Start</a>
    <a class="dropdown-item" href="../articles/repeated_measurements.html">Repeated Measurements</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">
    <span class="fa fa-newspaper"></span>
     
    News
  </a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/AparicioJohan/agriutilities">
    <span class="fa fa-github"></span>
     
    Github
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Repeated Measurements</h1>
                        <h4 data-toc-skip class="author">Johan
Aparicio</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/AparicioJohan/agriutilities/blob/HEAD/vignettes/repeated_measurements.Rmd" class="external-link"><code>vignettes/repeated_measurements.Rmd</code></a></small>
      <div class="d-none name"><code>repeated_measurements.Rmd</code></div>
    </div>

    
    
<p>The <code><a href="../reference/extract_rcov.html">extract_rcov()</a></code> function is a practical tool for
extracting the residual variance-covariance matrix from a repeated
measurement ASReml model. This function is particularly useful when
dealing with various covariance structures, including but not limited to
the uniform correlation (corv), power or exponential (expv),
antedependence (ante), unstructured (US), and Autoregressive Correlation
1 (ar1).</p>
<p><a href="https://www.youtube.com/watch?v=BwvTFZDejXI" class="external-link">Watch the
tutorial</a>: A good guide on fitting repeated measurement models in
ASReml by VSNi. However, it might leave you wondering how to actually
extract the fitted residual variance-covariance matrix. That’s where
<code><a href="../reference/extract_rcov.html">extract_rcov()</a></code> comes into play.</p>
<p>This vignette utilizes the same dataset featured in the video and
incorporates a segment of the code to showcase the functionality of
<code><a href="../reference/extract_rcov.html">extract_rcov()</a></code>. Additionally, we provide insightful figures
that aid in exploring the results.</p>
<blockquote>
<p>To run this vignette, ensure you have an ASReml license.</p>
</blockquote>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/AparicioJohan/agriutilities" class="external-link">agriutilities</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"asreml"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">asreml</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">grassUV</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">grassUV</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">Plant</span>, color <span class="op">=</span> <span class="va">Plant</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Tmt</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Online License checked out Fri Jan 19 17:04:49 2024</span></span>
<span><span class="co">#&gt;   Tmt Plant Time HeightID    y</span></span>
<span><span class="co">#&gt; 1 MAV     1    1       y1 21.0</span></span>
<span><span class="co">#&gt; 2 MAV     1    3       y3 39.7</span></span>
<span><span class="co">#&gt; 3 MAV     1    5       y5 47.0</span></span>
<span><span class="co">#&gt; 4 MAV     1    7       y7 53.0</span></span>
<span><span class="co">#&gt; 5 MAV     1   10      y10 55.0</span></span>
<span><span class="co">#&gt; 6 MAV     2    1       y1 32.0</span></span></code></pre></div>
<p><img src="repeated_measurements_files/figure-html/unnamed-chunk-1-1.png" width="864"></p>
<div class="section level2">
<h2 id="exploration">Exploration<a class="anchor" aria-label="anchor" href="#exploration"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"asreml"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="va">grassUV</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Time</span>, <span class="va">Plant</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html" class="external-link">spread</a></span><span class="op">(</span><span class="va">Time</span>, <span class="va">mean</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"Plant"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/covcor_heat.html">covcor_heat</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span>,</span>
<span>    legend <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">4.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Pearson Correlation"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">b</span> <span class="op">&lt;-</span> <span class="va">tmp</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span>use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="st">"DAP2"</span>, <span class="st">"corr"</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/type.convert.html" class="external-link">type.convert</a></span><span class="op">(</span>as.is <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>corr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">Time</span> <span class="op">&lt;</span> <span class="va">DAP2</span>, <span class="cn">NA</span>, <span class="va">corr</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>DAP2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">DAP2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">corr</span>, group <span class="op">=</span> <span class="va">DAP2</span>, color <span class="op">=</span> <span class="va">DAP2</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/set_palette.html" class="external-link">color_palette</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"jco"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Time"</span>, y <span class="op">=</span> <span class="st">"Pearson Correlation"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="repeated_measurements_files/figure-html/unnamed-chunk-2-1.png" width="864"></p>
</div>
<div class="section level2">
<h2 id="modeling">Modeling<a class="anchor" aria-label="anchor" href="#modeling"></a>
</h2>
<p>Let’s fit several models with different variance-covariance
structures:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"asreml"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Identity variance model.</span></span>
<span>  <span class="va">model_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html" class="external-link">asreml</a></span><span class="op">(</span></span>
<span>    fixed <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Tmt</span> <span class="op">+</span> <span class="va">Tmt</span><span class="op">:</span><span class="va">Time</span>,</span>
<span>    residual <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/defunct.html" class="external-link">id</a></span><span class="op">(</span><span class="va">Plant</span><span class="op">)</span><span class="op">:</span><span class="fu">idv</span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="va">grassUV</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Simple correlation model; homogeneous variance form.</span></span>
<span>  <span class="va">model_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html" class="external-link">asreml</a></span><span class="op">(</span></span>
<span>    fixed <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Tmt</span> <span class="op">+</span> <span class="va">Tmt</span><span class="op">:</span><span class="va">Time</span>,</span>
<span>    residual <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/defunct.html" class="external-link">id</a></span><span class="op">(</span><span class="va">Plant</span><span class="op">)</span><span class="op">:</span><span class="fu">corv</span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="va">grassUV</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Exponential (or power) model; homogeneous variance form.</span></span>
<span>  <span class="va">model_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html" class="external-link">asreml</a></span><span class="op">(</span></span>
<span>    fixed <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Tmt</span> <span class="op">+</span> <span class="va">Tmt</span><span class="op">:</span><span class="va">Time</span>,</span>
<span>    residual <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/defunct.html" class="external-link">id</a></span><span class="op">(</span><span class="va">Plant</span><span class="op">)</span><span class="op">:</span><span class="fu">expv</span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="va">grassUV</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Exponential (or power) model; heterogeneous variance form.</span></span>
<span>  <span class="va">model_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html" class="external-link">asreml</a></span><span class="op">(</span></span>
<span>    fixed <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Tmt</span> <span class="op">+</span> <span class="va">Tmt</span><span class="op">:</span><span class="va">Time</span>,</span>
<span>    residual <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/defunct.html" class="external-link">id</a></span><span class="op">(</span><span class="va">Plant</span><span class="op">)</span><span class="op">:</span><span class="fu">exph</span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="va">grassUV</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Antedependence variance model of order 1</span></span>
<span>  <span class="va">model_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html" class="external-link">asreml</a></span><span class="op">(</span></span>
<span>    fixed <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Tmt</span> <span class="op">+</span> <span class="va">Tmt</span><span class="op">:</span><span class="va">Time</span>,</span>
<span>    residual <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/defunct.html" class="external-link">id</a></span><span class="op">(</span><span class="va">Plant</span><span class="op">)</span><span class="op">:</span><span class="fu">ante</span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="va">grassUV</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Autoregressive model of order 1; homogeneous variance form.</span></span>
<span>  <span class="va">model_5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html" class="external-link">asreml</a></span><span class="op">(</span></span>
<span>    fixed <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Tmt</span> <span class="op">+</span> <span class="va">Tmt</span><span class="op">:</span><span class="va">Time</span>,</span>
<span>    residual <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/defunct.html" class="external-link">id</a></span><span class="op">(</span><span class="va">Plant</span><span class="op">)</span><span class="op">:</span><span class="fu">ar1v</span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="va">grassUV</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Autoregressive model of order 1; heterogeneous variance form.</span></span>
<span>  <span class="va">model_6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html" class="external-link">asreml</a></span><span class="op">(</span></span>
<span>    fixed <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Tmt</span> <span class="op">+</span> <span class="va">Tmt</span><span class="op">:</span><span class="va">Time</span>,</span>
<span>    residual <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/defunct.html" class="external-link">id</a></span><span class="op">(</span><span class="va">Plant</span><span class="op">)</span><span class="op">:</span><span class="fu">ar1h</span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="va">grassUV</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Unstructured variance model.</span></span>
<span>  <span class="va">model_7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html" class="external-link">asreml</a></span><span class="op">(</span></span>
<span>    fixed <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Tmt</span> <span class="op">+</span> <span class="va">Tmt</span><span class="op">:</span><span class="va">Time</span>,</span>
<span>    residual <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/defunct.html" class="external-link">id</a></span><span class="op">(</span><span class="va">Plant</span><span class="op">)</span><span class="op">:</span><span class="fu">us</span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="va">grassUV</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model-comparison">Model Comparison<a class="anchor" aria-label="anchor" href="#model-comparison"></a>
</h2>
<p>We can use the Akaike Information Criterion (AIC)(Akaike, 1974) or
the Bayesian Information Criterion (BIC)(Stone, 1979) for comparing the
fitted models. A lower AIC or BIC value indicates a better fit.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"asreml"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"idv"</span> <span class="op">=</span> <span class="va">model_0</span>,</span>
<span>    <span class="st">"corv"</span> <span class="op">=</span> <span class="va">model_1</span>,</span>
<span>    <span class="st">"expv"</span> <span class="op">=</span> <span class="va">model_2</span>,</span>
<span>    <span class="st">"exph"</span> <span class="op">=</span> <span class="va">model_3</span>,</span>
<span>    <span class="st">"ante"</span> <span class="op">=</span> <span class="va">model_4</span>,</span>
<span>    <span class="st">"ar1v"</span> <span class="op">=</span> <span class="va">model_5</span>,</span>
<span>    <span class="st">"ar1h"</span> <span class="op">=</span> <span class="va">model_6</span>,</span>
<span>    <span class="st">"us"</span> <span class="op">=</span> <span class="va">model_7</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">summary_models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">models</span><span class="op">)</span>,</span>
<span>    aic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">models</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">aic</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    bic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">models</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">bic</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    loglik <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">models</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">loglik</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    nedf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">models</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">nedf</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">models</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">aic</span>, <span class="st">"param"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    row.names <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">summary_models</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">summary_models</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">model</span>, <span class="op">-</span><span class="va">bic</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">bic</span>, group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">model</span>, y <span class="op">=</span> <span class="va">bic</span> <span class="op">+</span> <span class="fl">5</span>, label <span class="op">=</span> <span class="va">param</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"BIC"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt;   model      aic      bic    loglik nedf param</span></span>
<span><span class="co">#&gt; 1   idv 420.8836 422.9779 -209.4418   60     1</span></span>
<span><span class="co">#&gt; 2  corv 397.7535 401.9422 -196.8768   60     2</span></span>
<span><span class="co">#&gt; 3  expv 369.9577 374.1464 -182.9788   60     2</span></span>
<span><span class="co">#&gt; 4  exph 354.9984 367.5645 -171.4992   60     6</span></span>
<span><span class="co">#&gt; 5  ante 338.7387 357.5878 -160.3694   60     9</span></span>
<span><span class="co">#&gt; 6  ar1v 366.1259 370.3146 -181.0630   60     2</span></span>
<span><span class="co">#&gt; 7  ar1h 351.1073 363.6734 -169.5536   60     6</span></span>
<span><span class="co">#&gt; 8    us 346.0712 377.4863 -158.0356   60    15</span></span></code></pre></div>
<p><img src="repeated_measurements_files/figure-html/unnamed-chunk-4-1.png" width="864"></p>
<p>In this specific scenario, the antedependence model emerges as the
optimal choice, as indicated by the Bayesian Information Criteria (BIC).
The 1-factor antedependence structure elegantly models the
variance-covariance matrix <span class="math inline">\(\Sigma^{\omega
\times\omega}\)</span> with the following decomposition:</p>
<p><span class="math display">\[ \Sigma ^{-1} = UDU' \]</span> where
<span class="math inline">\(U^{\omega \times\omega}\)</span> is a unit
upper triangular matrix and <span class="math inline">\(D = diag(d_1,
..., d_{\omega})\)</span>. The <code><a href="../reference/extract_rcov.html">extract_rcov()</a></code> retrieves
these matrices for a closer inspection of the results.</p>
</div>
<div class="section level2">
<h2 id="extracting-variance-covariance-matrix">Extracting Variance Covariance Matrix<a class="anchor" aria-label="anchor" href="#extracting-variance-covariance-matrix"></a>
</h2>
<p>As an example of extracting the variance-covariance matrix, let’s
take the best model according to the BIC, and run this line of code:
<code>extract_rcov(model_4)</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"asreml"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_rcov.html">extract_rcov</a></span><span class="op">(</span><span class="va">model_4</span>, time <span class="op">=</span> <span class="st">"Time"</span>, plot <span class="op">=</span> <span class="st">"Plant"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Plotting  Matrix</span></span>
<span>  <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/covcor_heat.html">covcor_heat</a></span><span class="op">(</span>matrix <span class="op">=</span> <span class="va">mat</span><span class="op">$</span><span class="va">corr</span>, legend <span class="op">=</span> <span class="st">"none"</span>, size <span class="op">=</span> <span class="fl">4.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Correlation Matrix (ante)"</span><span class="op">)</span></span>
<span>  <span class="va">p1</span></span>
<span></span>
<span>  <span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/covcor_heat.html">covcor_heat</a></span><span class="op">(</span></span>
<span>    matrix <span class="op">=</span> <span class="va">mat</span><span class="op">$</span><span class="va">vcov</span>,</span>
<span>    corr <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    legend <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">4.5</span>,</span>
<span>    digits <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Covariance Matrix (ante)"</span><span class="op">)</span></span>
<span>  <span class="va">p2</span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; $corr_mat</span></span>
<span><span class="co">#&gt;            1         3         5         7        10</span></span>
<span><span class="co">#&gt; 1  1.0000000 0.5949600 0.3551374 0.3117083 0.3042604</span></span>
<span><span class="co">#&gt; 3  0.5949600 1.0000000 0.5969097 0.5239148 0.5113965</span></span>
<span><span class="co">#&gt; 5  0.3551374 0.5969097 1.0000000 0.8777119 0.8567400</span></span>
<span><span class="co">#&gt; 7  0.3117083 0.5239148 0.8777119 1.0000000 0.9761062</span></span>
<span><span class="co">#&gt; 10 0.3042604 0.5113965 0.8567400 0.9761062 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vcov_mat</span></span>
<span><span class="co">#&gt;           1        3         5         7        10</span></span>
<span><span class="co">#&gt; 1  37.22092 23.38866  34.87475  44.65979  43.22207</span></span>
<span><span class="co">#&gt; 3  23.38866 41.51911  61.90901  79.27923  76.72701</span></span>
<span><span class="co">#&gt; 5  34.87475 61.90901 259.08503 331.77822 321.09738</span></span>
<span><span class="co">#&gt; 7  44.65979 79.27923 331.77822 551.50497 533.75052</span></span>
<span><span class="co">#&gt; 10 43.22207 76.72701 321.09738 533.75052 542.16700</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vc</span></span>
<span><span class="co">#&gt; [1] "ante"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $U</span></span>
<span><span class="co">#&gt;    1         3         5         7         10</span></span>
<span><span class="co">#&gt; 1  1 -0.628374  0.000000  0.000000  0.0000000</span></span>
<span><span class="co">#&gt; 3  0  1.000000 -1.491097  0.000000  0.0000000</span></span>
<span><span class="co">#&gt; 5  0  0.000000  1.000000 -1.280577  0.0000000</span></span>
<span><span class="co">#&gt; 7  0  0.000000  0.000000  1.000000 -0.9678073</span></span>
<span><span class="co">#&gt; 10 0  0.000000  0.000000  0.000000  1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $D</span></span>
<span><span class="co">#&gt;             1          3           5           7         10</span></span>
<span><span class="co">#&gt; 1  0.02686661 0.00000000 0.000000000 0.000000000 0.00000000</span></span>
<span><span class="co">#&gt; 3  0.00000000 0.03728243 0.000000000 0.000000000 0.00000000</span></span>
<span><span class="co">#&gt; 5  0.00000000 0.00000000 0.005996185 0.000000000 0.00000000</span></span>
<span><span class="co">#&gt; 7  0.00000000 0.00000000 0.000000000 0.007896552 0.00000000</span></span>
<span><span class="co">#&gt; 10 0.00000000 0.00000000 0.000000000 0.000000000 0.03906346</span></span></code></pre></div>
<p><img src="repeated_measurements_files/figure-html/unnamed-chunk-5-1.png" width="864"></p>
</div>
<div class="section level2">
<h2 id="comparison">Comparison<a class="anchor" aria-label="anchor" href="#comparison"></a>
</h2>
<p>The plot below unveils the correlation matrices, comparing the raw
data matrix with the one derived post-application of the antedependence
model.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"asreml"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">p1</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="repeated_measurements_files/figure-html/unnamed-chunk-6-1.png" width="864"></p>
</div>
<div class="section level2">
<h2 id="final-results">Final Results<a class="anchor" aria-label="anchor" href="#final-results"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"asreml"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">pvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model_4</span>, classify <span class="op">=</span> <span class="st">"Tmt:Time"</span><span class="op">)</span><span class="op">$</span><span class="va">pvals</span></span>
<span>  <span class="va">grassUV</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">Tmt</span>, color <span class="op">=</span> <span class="va">Tmt</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pvals</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">predicted.value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"grey50"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Tmt</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="repeated_measurements_files/figure-html/unnamed-chunk-7-1.png" width="864"></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p><a href="https://asreml.kb.vsni.co.uk/wp-content/uploads/sites/3/ASReml-R-Reference-Manual-4.2.pdf" class="external-link">ASReml-R
Reference Manual</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Johan Aparicio, Alexia Bornhorst.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
