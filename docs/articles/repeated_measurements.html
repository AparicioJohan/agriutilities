<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="agriutilities">
<title>Repeated Measurements • agriutilities</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Repeated Measurements">
<meta property="og:description" content="agriutilities">
<meta property="og:image" content="https://apariciojohan.github.io/agriutilities/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-secondary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">agriutilities</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
    Home
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa-code"></span>
     
    Reference
  </a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--articles">
    <span class="fa fa-book"></span>
     
    Articles
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--articles">
    <a class="dropdown-item" href="../articles/how-to-start.html">How to Start</a>
    <a class="dropdown-item" href="../articles/repeated_measurements.html">Repeated Measurements</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">
    <span class="fa fa-newspaper"></span>
     
    News
  </a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/AparicioJohan/agriutilities">
    <span class="fa fa-github"></span>
     
    Github
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Repeated Measurements</h1>
                        <h4 data-toc-skip class="author">Johan
Aparicio</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/AparicioJohan/agriutilities/blob/HEAD/vignettes/repeated_measurements.Rmd" class="external-link"><code>vignettes/repeated_measurements.Rmd</code></a></small>
      <div class="d-none name"><code>repeated_measurements.Rmd</code></div>
    </div>

    
    
<p>The <code><a href="../reference/extract_rcov.html">extract_rcov()</a></code> function is a practical tool for
extracting the residual variance-covariance matrix from a repeated
measurement ASReml model. This function is particularly useful when
dealing with various covariance structures, including but not limited to
the uniform correlation (corv), power or exponential (expv),
antedependence (ante) and unstructured (US).</p>
<p>Currently, the structures available are:</p>
<ol style="list-style-type: decimal">
<li>Simple correlation model (<code>corv</code>); homogeneous variance
form.</li>
<li>Simple correlation model (<code>corh</code>); heterogeneous variance
form.</li>
<li>General correlation model (<code>corgh</code>); heterogeneous
variance form.</li>
<li>Exponential (or power) model (<code>expv</code>); homogeneous
variance form.</li>
<li>Exponential (or power) model (<code>exph</code>); heterogeneous
variance form.</li>
<li>Autoregressive model of order 1 (<code>ar1v</code>); homogeneous
variance form.</li>
<li>Autoregressive model of order 1 (<code>ar1h</code>); heterogeneous
variance form.</li>
<li>Antedependence variance model of order 1 (<code>ante</code>).</li>
<li>Unstructured variance model (<code>us</code>).</li>
</ol>
<p><a href="https://www.youtube.com/watch?v=BwvTFZDejXI" class="external-link">Watch the
tutorial</a>: A good guide on fitting repeated measurement models in
ASReml by VSNi. However, it might leave you wondering how to actually
extract the fitted residual variance-covariance matrix. That’s where
<code><a href="../reference/extract_rcov.html">extract_rcov()</a></code> comes into play.</p>
<p>This vignette utilizes the same dataset featured in the video and
incorporates a segment of the code to showcase the functionality of
<code><a href="../reference/extract_rcov.html">extract_rcov()</a></code>. Additionally, we provide insightful figures
that aid in exploring the results.</p>
<blockquote>
<p>To run this vignette, ensure you have an ASReml license.</p>
</blockquote>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/AparicioJohan/agriutilities" class="external-link">agriutilities</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">asreml</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">grassUV</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">grassUV</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">Plant</span>, color <span class="op">=</span> <span class="va">Plant</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Tmt</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Online License checked out Tue Jan 30 10:20:38 2024</span></span>
<span><span class="co">#&gt;   Tmt Plant Time HeightID    y</span></span>
<span><span class="co">#&gt; 1 MAV     1    1       y1 21.0</span></span>
<span><span class="co">#&gt; 2 MAV     1    3       y3 39.7</span></span>
<span><span class="co">#&gt; 3 MAV     1    5       y5 47.0</span></span>
<span><span class="co">#&gt; 4 MAV     1    7       y7 53.0</span></span>
<span><span class="co">#&gt; 5 MAV     1   10      y10 55.0</span></span>
<span><span class="co">#&gt; 6 MAV     2    1       y1 32.0</span></span></code></pre>
<p><img src="repeated_measurements_files/figure-html/unnamed-chunk-2-1.png" width="864"></p>
<div class="section level2">
<h2 id="exploration">Exploration<a class="anchor" aria-label="anchor" href="#exploration"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="va">grassUV</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Time</span>, <span class="va">Plant</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html" class="external-link">spread</a></span><span class="op">(</span><span class="va">Time</span>, <span class="va">mean</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"Plant"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/covcor_heat.html">covcor_heat</a></span><span class="op">(</span>matrix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span>, legend <span class="op">=</span> <span class="st">"none"</span>, size <span class="op">=</span> <span class="fl">4.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Pearson Correlation"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="va">tmp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span>use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"Time"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="st">"Time2"</span>, <span class="st">"corr"</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/type.convert.html" class="external-link">type.convert</a></span><span class="op">(</span>as.is <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>corr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">Time</span> <span class="op">&lt;</span> <span class="va">Time2</span>, <span class="cn">NA</span>, <span class="va">corr</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Time2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Time2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">corr</span>, group <span class="op">=</span> <span class="va">Time2</span>, color <span class="op">=</span> <span class="va">Time2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/set_palette.html" class="external-link">color_palette</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"jco"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Time"</span>, y <span class="op">=</span> <span class="st">"Pearson Correlation"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span></span></code></pre></div>
<p><img src="repeated_measurements_files/figure-html/unnamed-chunk-4-1.png" width="864"></p>
</div>
<div class="section level2">
<h2 id="modeling">Modeling<a class="anchor" aria-label="anchor" href="#modeling"></a>
</h2>
<p>Let’s fit several models with different variance-covariance
structures:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Identity variance model.</span></span>
<span><span class="va">model_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html" class="external-link">asreml</a></span><span class="op">(</span></span>
<span>  fixed <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Tmt</span> <span class="op">+</span> <span class="va">Tmt</span><span class="op">:</span><span class="va">Time</span>,</span>
<span>  residual <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/defunct.html" class="external-link">id</a></span><span class="op">(</span><span class="va">Plant</span><span class="op">)</span><span class="op">:</span><span class="fu">idv</span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">grassUV</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simple correlation model; homogeneous variance form.</span></span>
<span><span class="va">model_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html" class="external-link">asreml</a></span><span class="op">(</span></span>
<span>  fixed <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Tmt</span> <span class="op">+</span> <span class="va">Tmt</span><span class="op">:</span><span class="va">Time</span>,</span>
<span>  residual <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/defunct.html" class="external-link">id</a></span><span class="op">(</span><span class="va">Plant</span><span class="op">)</span><span class="op">:</span><span class="fu">corv</span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">grassUV</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Exponential (or power) model; homogeneous variance form.</span></span>
<span><span class="va">model_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html" class="external-link">asreml</a></span><span class="op">(</span></span>
<span>  fixed <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Tmt</span> <span class="op">+</span> <span class="va">Tmt</span><span class="op">:</span><span class="va">Time</span>,</span>
<span>  residual <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/defunct.html" class="external-link">id</a></span><span class="op">(</span><span class="va">Plant</span><span class="op">)</span><span class="op">:</span><span class="fu">expv</span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">grassUV</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Exponential (or power) model; heterogeneous variance form.</span></span>
<span><span class="va">model_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html" class="external-link">asreml</a></span><span class="op">(</span></span>
<span>  fixed <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Tmt</span> <span class="op">+</span> <span class="va">Tmt</span><span class="op">:</span><span class="va">Time</span>,</span>
<span>  residual <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/defunct.html" class="external-link">id</a></span><span class="op">(</span><span class="va">Plant</span><span class="op">)</span><span class="op">:</span><span class="fu">exph</span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">grassUV</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Antedependence variance model of order 1</span></span>
<span><span class="va">model_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html" class="external-link">asreml</a></span><span class="op">(</span></span>
<span>  fixed <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Tmt</span> <span class="op">+</span> <span class="va">Tmt</span><span class="op">:</span><span class="va">Time</span>,</span>
<span>  residual <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/defunct.html" class="external-link">id</a></span><span class="op">(</span><span class="va">Plant</span><span class="op">)</span><span class="op">:</span><span class="fu">ante</span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">grassUV</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Autoregressive model of order 1; homogeneous variance form.</span></span>
<span><span class="va">model_5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html" class="external-link">asreml</a></span><span class="op">(</span></span>
<span>  fixed <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Tmt</span> <span class="op">+</span> <span class="va">Tmt</span><span class="op">:</span><span class="va">Time</span>,</span>
<span>  residual <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/defunct.html" class="external-link">id</a></span><span class="op">(</span><span class="va">Plant</span><span class="op">)</span><span class="op">:</span><span class="fu">ar1v</span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">grassUV</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Autoregressive model of order 1; heterogeneous variance form.</span></span>
<span><span class="va">model_6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html" class="external-link">asreml</a></span><span class="op">(</span></span>
<span>  fixed <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Tmt</span> <span class="op">+</span> <span class="va">Tmt</span><span class="op">:</span><span class="va">Time</span>,</span>
<span>  residual <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/defunct.html" class="external-link">id</a></span><span class="op">(</span><span class="va">Plant</span><span class="op">)</span><span class="op">:</span><span class="fu">ar1h</span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">grassUV</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Unstructured variance model.</span></span>
<span><span class="va">model_7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html" class="external-link">asreml</a></span><span class="op">(</span></span>
<span>  fixed <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">Time</span> <span class="op">+</span> <span class="va">Tmt</span> <span class="op">+</span> <span class="va">Tmt</span><span class="op">:</span><span class="va">Time</span>,</span>
<span>  residual <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/defunct.html" class="external-link">id</a></span><span class="op">(</span><span class="va">Plant</span><span class="op">)</span><span class="op">:</span><span class="fu">us</span><span class="op">(</span><span class="va">Time</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">grassUV</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model-comparison">Model Comparison<a class="anchor" aria-label="anchor" href="#model-comparison"></a>
</h2>
<p>We can use the Akaike Information Criterion (AIC)(Akaike, 1974) or
the Bayesian Information Criterion (BIC)(Stone, 1979) for comparing the
fitted models. A lower AIC or BIC value indicates a better fit.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"idv"</span> <span class="op">=</span> <span class="va">model_0</span>,</span>
<span>  <span class="st">"corv"</span> <span class="op">=</span> <span class="va">model_1</span>,</span>
<span>  <span class="st">"expv"</span> <span class="op">=</span> <span class="va">model_2</span>,</span>
<span>  <span class="st">"exph"</span> <span class="op">=</span> <span class="va">model_3</span>,</span>
<span>  <span class="st">"ante"</span> <span class="op">=</span> <span class="va">model_4</span>,</span>
<span>  <span class="st">"ar1v"</span> <span class="op">=</span> <span class="va">model_5</span>,</span>
<span>  <span class="st">"ar1h"</span> <span class="op">=</span> <span class="va">model_6</span>,</span>
<span>  <span class="st">"us"</span> <span class="op">=</span> <span class="va">model_7</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">summary_models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">models</span><span class="op">)</span>,</span>
<span>  aic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">models</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">aic</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  bic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">models</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">bic</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  loglik <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">models</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">loglik</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  nedf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">models</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">nedf</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">models</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">aic</span>, <span class="st">"param"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  row.names <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">summary_models</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">summary_models</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">model</span>, <span class="op">-</span><span class="va">bic</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">bic</span>, group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">model</span>, y <span class="op">=</span> <span class="va">bic</span> <span class="op">+</span> <span class="fl">5</span>, label <span class="op">=</span> <span class="va">param</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"BIC"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;   model      aic      bic    loglik nedf param</span></span>
<span><span class="co">#&gt; 1   idv 420.8836 422.9779 -209.4418   60     1</span></span>
<span><span class="co">#&gt; 2  corv 397.7535 401.9422 -196.8768   60     2</span></span>
<span><span class="co">#&gt; 3  expv 369.9577 374.1464 -182.9788   60     2</span></span>
<span><span class="co">#&gt; 4  exph 354.9984 367.5645 -171.4992   60     6</span></span>
<span><span class="co">#&gt; 5  ante 338.7387 357.5878 -160.3694   60     9</span></span>
<span><span class="co">#&gt; 6  ar1v 366.1259 370.3146 -181.0630   60     2</span></span>
<span><span class="co">#&gt; 7  ar1h 351.1073 363.6734 -169.5536   60     6</span></span>
<span><span class="co">#&gt; 8    us 346.0712 377.4863 -158.0356   60    15</span></span></code></pre>
<p><img src="repeated_measurements_files/figure-html/unnamed-chunk-8-1.png" width="864"></p>
<p>In this specific scenario, the antedependence model emerges as the
optimal choice, as indicated by the Bayesian Information Criteria (BIC).
The 1-factor antedependence structure elegantly models the
variance-covariance matrix <span class="math inline">\(\Sigma^{\omega
\times\omega}\)</span> with the following decomposition:</p>
<p><span class="math display">\[ \Sigma ^{-1} = UDU' \]</span> where
<span class="math inline">\(U^{\omega \times\omega}\)</span> is a unit
upper triangular matrix and <span class="math inline">\(D = diag(d_1,
..., d_{\omega})\)</span> is a diagonal matrix.</p>
<span class="math display">\[\begin{array}{rcl}
U_{ii} &amp; = &amp; 1 \\
U_{ij} &amp; = &amp; u_{ij}, \;\; 1 \le j-i\le order \\
U_{ij} &amp; = &amp; 0, \;\; i&gt;j
\end{array}\]</span>
<p>and the order in our case is 1.</p>
<p>The <code><a href="../reference/extract_rcov.html">extract_rcov()</a></code> retrieves these matrices for a closer
inspection of the results.</p>
</div>
<div class="section level2">
<h2 id="wald-test">Wald Test<a class="anchor" aria-label="anchor" href="#wald-test"></a>
</h2>
<p>The table below shows the summary of Wald statistics for fixed
effects for the models fitted.</p>
<div id="hkmouwpzeq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hkmouwpzeq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hkmouwpzeq thead, #hkmouwpzeq tbody, #hkmouwpzeq tfoot, #hkmouwpzeq tr, #hkmouwpzeq td, #hkmouwpzeq th {
  border-style: none;
}

#hkmouwpzeq p {
  margin: 0;
  padding: 0;
}

#hkmouwpzeq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hkmouwpzeq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hkmouwpzeq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hkmouwpzeq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hkmouwpzeq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hkmouwpzeq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hkmouwpzeq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hkmouwpzeq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hkmouwpzeq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hkmouwpzeq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hkmouwpzeq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hkmouwpzeq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hkmouwpzeq .gt_spanner_row {
  border-bottom-style: hidden;
}

#hkmouwpzeq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hkmouwpzeq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hkmouwpzeq .gt_from_md > :first-child {
  margin-top: 0;
}

#hkmouwpzeq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hkmouwpzeq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hkmouwpzeq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hkmouwpzeq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hkmouwpzeq .gt_row_group_first td {
  border-top-width: 2px;
}

#hkmouwpzeq .gt_row_group_first th {
  border-top-width: 2px;
}

#hkmouwpzeq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hkmouwpzeq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hkmouwpzeq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hkmouwpzeq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hkmouwpzeq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hkmouwpzeq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hkmouwpzeq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hkmouwpzeq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hkmouwpzeq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hkmouwpzeq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hkmouwpzeq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hkmouwpzeq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hkmouwpzeq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hkmouwpzeq .gt_left {
  text-align: left;
}

#hkmouwpzeq .gt_center {
  text-align: center;
}

#hkmouwpzeq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hkmouwpzeq .gt_font_normal {
  font-weight: normal;
}

#hkmouwpzeq .gt_font_bold {
  font-weight: bold;
}

#hkmouwpzeq .gt_font_italic {
  font-style: italic;
}

#hkmouwpzeq .gt_super {
  font-size: 65%;
}

#hkmouwpzeq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hkmouwpzeq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hkmouwpzeq .gt_indent_1 {
  text-indent: 5px;
}

#hkmouwpzeq .gt_indent_2 {
  text-indent: 10px;
}

#hkmouwpzeq .gt_indent_3 {
  text-indent: 15px;
}

#hkmouwpzeq .gt_indent_4 {
  text-indent: 20px;
}

#hkmouwpzeq .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings gt_spanner_row">
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="2" colspan="1" scope="col" id="Model">Model</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="Time">
        <span class="gt_column_spanner">Time</span>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="Tmt">
        <span class="gt_column_spanner">Tmt</span>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="Tmt:Time">
        <span class="gt_column_spanner">Tmt:Time</span>
      </th>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="F.value">F.value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="P.value">P.value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="F.value">F.value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="P.value">P.value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="F.value">F.value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="P.value">P.value</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td headers="Model" class="gt_row gt_center">idv</td>
<td headers="F.con_Time" class="gt_row gt_center">24.06</td>
<td headers="Pr_Time" class="gt_row gt_center">0</td>
<td headers="F.con_Tmt" class="gt_row gt_center">30.410</td>
<td headers="Pr_Tmt" class="gt_row gt_center">0.000</td>
<td headers="F.con_Tmt:Time" class="gt_row gt_center">2.254</td>
<td headers="Pr_Tmt:Time" class="gt_row gt_center" style="background-color: #C12424; color: #FFFFFF;">0.074</td>
</tr>
<tr>
<td headers="Model" class="gt_row gt_center">corv</td>
<td headers="F.con_Time" class="gt_row gt_center">54.46</td>
<td headers="Pr_Time" class="gt_row gt_center">0</td>
<td headers="F.con_Tmt" class="gt_row gt_center">9.407</td>
<td headers="Pr_Tmt" class="gt_row gt_center">0.010</td>
<td headers="F.con_Tmt:Time" class="gt_row gt_center">5.101</td>
<td headers="Pr_Tmt:Time" class="gt_row gt_center" style="background-color: #FFE4E8; color: #000000;">0.002</td>
</tr>
<tr>
<td headers="Model" class="gt_row gt_center">expv</td>
<td headers="F.con_Time" class="gt_row gt_center">39.75</td>
<td headers="Pr_Time" class="gt_row gt_center">0</td>
<td headers="F.con_Tmt" class="gt_row gt_center">6.874</td>
<td headers="Pr_Tmt" class="gt_row gt_center">0.023</td>
<td headers="F.con_Tmt:Time" class="gt_row gt_center">6.116</td>
<td headers="Pr_Tmt:Time" class="gt_row gt_center" style="background-color: #FFEBEE; color: #000000;">0.000</td>
</tr>
<tr>
<td headers="Model" class="gt_row gt_center">exph</td>
<td headers="F.con_Time" class="gt_row gt_center">51.98</td>
<td headers="Pr_Time" class="gt_row gt_center">0</td>
<td headers="F.con_Tmt" class="gt_row gt_center">0.000</td>
<td headers="Pr_Tmt" class="gt_row gt_center">0.984</td>
<td headers="F.con_Tmt:Time" class="gt_row gt_center">4.322</td>
<td headers="Pr_Tmt:Time" class="gt_row gt_center" style="background-color: #FCC1C4; color: #000000;">0.011</td>
</tr>
<tr>
<td headers="Model" class="gt_row gt_center">ante</td>
<td headers="F.con_Time" class="gt_row gt_center">33.89</td>
<td headers="Pr_Time" class="gt_row gt_center">0</td>
<td headers="F.con_Tmt" class="gt_row gt_center">4.139</td>
<td headers="Pr_Tmt" class="gt_row gt_center">0.064</td>
<td headers="F.con_Tmt:Time" class="gt_row gt_center">3.345</td>
<td headers="Pr_Tmt:Time" class="gt_row gt_center" style="background-color: #F14F49; color: #FFFFFF;">0.038</td>
</tr>
<tr>
<td headers="Model" class="gt_row gt_center">ar1v</td>
<td headers="F.con_Time" class="gt_row gt_center">39.24</td>
<td headers="Pr_Time" class="gt_row gt_center">0</td>
<td headers="F.con_Tmt" class="gt_row gt_center">6.912</td>
<td headers="Pr_Tmt" class="gt_row gt_center">0.023</td>
<td headers="F.con_Tmt:Time" class="gt_row gt_center">6.001</td>
<td headers="Pr_Tmt:Time" class="gt_row gt_center" style="background-color: #FFE8EB; color: #000000;">0.001</td>
</tr>
<tr>
<td headers="Model" class="gt_row gt_center">ar1h</td>
<td headers="F.con_Time" class="gt_row gt_center">51.24</td>
<td headers="Pr_Time" class="gt_row gt_center">0</td>
<td headers="F.con_Tmt" class="gt_row gt_center">0.007</td>
<td headers="Pr_Tmt" class="gt_row gt_center">0.937</td>
<td headers="F.con_Tmt:Time" class="gt_row gt_center">4.325</td>
<td headers="Pr_Tmt:Time" class="gt_row gt_center" style="background-color: #FDC7CB; color: #000000;">0.010</td>
</tr>
<tr>
<td headers="Model" class="gt_row gt_center">us</td>
<td headers="F.con_Time" class="gt_row gt_center">40.47</td>
<td headers="Pr_Time" class="gt_row gt_center">0</td>
<td headers="F.con_Tmt" class="gt_row gt_center">1.715</td>
<td headers="Pr_Tmt" class="gt_row gt_center">0.215</td>
<td headers="F.con_Tmt:Time" class="gt_row gt_center">3.344</td>
<td headers="Pr_Tmt:Time" class="gt_row gt_center" style="background-color: #D53030; color: #FFFFFF;">0.061</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="variance-components">Variance Components<a class="anchor" aria-label="anchor" href="#variance-components"></a>
</h2>
<p>At first glance, the table below looks challenging to interpret;
however, the function translates the summary output into tangible
forms—both the actual variance-covariance matrix and the correlation
matrix.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_4</span><span class="op">)</span><span class="op">$</span><span class="va">varcomp</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;                          component   std.error    z.ratio bound %ch</span></span>
<span><span class="co">#&gt; Plant:Time!R           1.000000000          NA         NA     F 0.0</span></span>
<span><span class="co">#&gt; Plant:Time!Time_1:1    0.026866609 0.011023605   2.437189     U 0.0</span></span>
<span><span class="co">#&gt; Plant:Time!Time_3:1   -0.628374025 0.246035667  -2.553996     U 0.0</span></span>
<span><span class="co">#&gt; Plant:Time!Time_3:3    0.037282432 0.015467375   2.410392     U 0.0</span></span>
<span><span class="co">#&gt; Plant:Time!Time_5:3   -1.491096654 0.586492845  -2.542395     U 0.1</span></span>
<span><span class="co">#&gt; Plant:Time!Time_5:5    0.005996185 0.002467878   2.429692     U 0.0</span></span>
<span><span class="co">#&gt; Plant:Time!Time_7:5   -1.280576604 0.206798510  -6.192388     U 0.0</span></span>
<span><span class="co">#&gt; Plant:Time!Time_7:7    0.007896552 0.003232983   2.442497     U 0.0</span></span>
<span><span class="co">#&gt; Plant:Time!Time_10:7  -0.967807268 0.062828991 -15.403833     U 0.0</span></span>
<span><span class="co">#&gt; Plant:Time!Time_10:10  0.039063461 0.015947580   2.449491     U 0.0</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="extracting-variance-covariance-matrix">Extracting Variance Covariance Matrix<a class="anchor" aria-label="anchor" href="#extracting-variance-covariance-matrix"></a>
</h2>
<p>Finally, to extract the variance-covariance matrix, let’s take the
best model according to the BIC and run the code:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_rcov.html">extract_rcov</a></span><span class="op">(</span><span class="va">model_4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $corr_mat</span></span>
<span><span class="co">#&gt;            1         3         5         7        10</span></span>
<span><span class="co">#&gt; 1  1.0000000 0.5949600 0.3551374 0.3117083 0.3042604</span></span>
<span><span class="co">#&gt; 3  0.5949600 1.0000000 0.5969097 0.5239148 0.5113965</span></span>
<span><span class="co">#&gt; 5  0.3551374 0.5969097 1.0000000 0.8777119 0.8567400</span></span>
<span><span class="co">#&gt; 7  0.3117083 0.5239148 0.8777119 1.0000000 0.9761062</span></span>
<span><span class="co">#&gt; 10 0.3042604 0.5113965 0.8567400 0.9761062 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vcov_mat</span></span>
<span><span class="co">#&gt;           1        3         5         7        10</span></span>
<span><span class="co">#&gt; 1  37.22092 23.38866  34.87475  44.65979  43.22207</span></span>
<span><span class="co">#&gt; 3  23.38866 41.51911  61.90901  79.27923  76.72701</span></span>
<span><span class="co">#&gt; 5  34.87475 61.90901 259.08503 331.77822 321.09738</span></span>
<span><span class="co">#&gt; 7  44.65979 79.27923 331.77822 551.50497 533.75052</span></span>
<span><span class="co">#&gt; 10 43.22207 76.72701 321.09738 533.75052 542.16700</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $vc</span></span>
<span><span class="co">#&gt; [1] "ante"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $U</span></span>
<span><span class="co">#&gt;    1         3         5         7         10</span></span>
<span><span class="co">#&gt; 1  1 -0.628374  0.000000  0.000000  0.0000000</span></span>
<span><span class="co">#&gt; 3  0  1.000000 -1.491097  0.000000  0.0000000</span></span>
<span><span class="co">#&gt; 5  0  0.000000  1.000000 -1.280577  0.0000000</span></span>
<span><span class="co">#&gt; 7  0  0.000000  0.000000  1.000000 -0.9678073</span></span>
<span><span class="co">#&gt; 10 0  0.000000  0.000000  0.000000  1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $D</span></span>
<span><span class="co">#&gt;             1          3           5           7         10</span></span>
<span><span class="co">#&gt; 1  0.02686661 0.00000000 0.000000000 0.000000000 0.00000000</span></span>
<span><span class="co">#&gt; 3  0.00000000 0.03728243 0.000000000 0.000000000 0.00000000</span></span>
<span><span class="co">#&gt; 5  0.00000000 0.00000000 0.005996185 0.000000000 0.00000000</span></span>
<span><span class="co">#&gt; 7  0.00000000 0.00000000 0.000000000 0.007896552 0.00000000</span></span>
<span><span class="co">#&gt; 10 0.00000000 0.00000000 0.000000000 0.000000000 0.03906346</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot Correlation  Matrix</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/covcor_heat.html">covcor_heat</a></span><span class="op">(</span>matrix <span class="op">=</span> <span class="va">mat</span><span class="op">$</span><span class="va">corr</span>, legend <span class="op">=</span> <span class="st">"none"</span>, size <span class="op">=</span> <span class="fl">4.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Correlation Matrix (ante)"</span><span class="op">)</span></span>
<span><span class="va">p1</span></span>
<span></span>
<span><span class="co"># Plot Variance-Covariance Matrix</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/covcor_heat.html">covcor_heat</a></span><span class="op">(</span></span>
<span>  matrix <span class="op">=</span> <span class="va">mat</span><span class="op">$</span><span class="va">vcov</span>,</span>
<span>  corr <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  legend <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  size <span class="op">=</span> <span class="fl">4.5</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Covariance Matrix (ante)"</span><span class="op">)</span></span>
<span><span class="va">p2</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span><span class="op">)</span></span></code></pre></div>
<p><img src="repeated_measurements_files/figure-html/unnamed-chunk-15-1.png" width="864"></p>
</div>
<div class="section level2">
<h2 id="matrix-comparison">Matrix Comparison<a class="anchor" aria-label="anchor" href="#matrix-comparison"></a>
</h2>
<p>The plot below compares the raw correlation matrix with the one
derived post-application of the antedependence model.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">p1</span><span class="op">)</span></span></code></pre></div>
<p><img src="repeated_measurements_files/figure-html/unnamed-chunk-17-1.png" width="864"></p>
</div>
<div class="section level2">
<h2 id="final-results">Final Results<a class="anchor" aria-label="anchor" href="#final-results"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model_4</span>, classify <span class="op">=</span> <span class="st">"Tmt:Time"</span><span class="op">)</span><span class="op">$</span><span class="va">pvals</span></span>
<span><span class="va">grassUV</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">Tmt</span>, color <span class="op">=</span> <span class="va">Tmt</span>, shape <span class="op">=</span> <span class="va">Tmt</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pvals</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">predicted.value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/set_palette.html" class="external-link">color_palette</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"jco"</span><span class="op">)</span></span></code></pre></div>
<p><img src="repeated_measurements_files/figure-html/unnamed-chunk-19-1.png" width="864"></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p><a href="https://asreml.kb.vsni.co.uk/wp-content/uploads/sites/3/ASReml-R-Reference-Manual-4.2.pdf" class="external-link">ASReml-R
Reference Manual</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Johan Aparicio, Alexia Bornhorst.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
