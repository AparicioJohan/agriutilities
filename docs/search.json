[{"path":"https://apariciojohan.github.io/agriutilities/articles/how-to-start.html","id":"identify-the-experimental-design","dir":"Articles","previous_headings":"","what":"Identify the Experimental Design","title":"How to Start","text":"function check_design_met helps us check quality data also identify experimental design trials. works quality check quality control fit model.","code":"library(agriutilities) library(agridat) #> Warning: package 'agridat' was built under R version 4.1.3 data(besag.met) dat <- besag.met results <- check_design_met(   data = dat,   genotype = \"gen\",   trial = \"county\",   traits = \"yield\",   rep = \"rep\",   block = \"block\",   col = \"col\",   row = \"row\" ) print(results) #> --------------------------------------------------------------------- #> Summary Traits by Trial: #> --------------------------------------------------------------------- #> # A tibble: 6 x 9 #>   county traits  Mean Median    SD    CV     n n_miss miss_perc #>   <fct>  <chr>  <dbl>  <dbl> <dbl> <dbl> <int>  <int>     <dbl> #> 1 C1     yield  149.   151.   17.7 0.119   198      6    0.0303 #> 2 C2     yield   56.1   52.1  18.4 0.328   198      6    0.0303 #> 3 C3     yield   87.9   89.2  19.7 0.225   198      6    0.0303 #> 4 C4     yield  145.   143.   17.1 0.118   198      6    0.0303 #> 5 C5     yield  115.   116.   16.4 0.142   198      6    0.0303 #> 6 C6     yield   87.6   87.8  26.6 0.304   198      6    0.0303 #>  #> --------------------------------------------------------------------- #> Experimental Design Detected: #> --------------------------------------------------------------------- #>   county exp_design #> 1     C1    row_col #> 2     C2    row_col #> 3     C3    row_col #> 4     C4    row_col #> 5     C5    row_col #> 6     C6    row_col #>  #> --------------------------------------------------------------------- #> Summary Experimental Design: #> --------------------------------------------------------------------- #> # A tibble: 6 x 9 #>   county     n n_gen n_rep n_block n_col n_row num_of_reps num_of_gen #>   <fct>  <int> <int> <int>   <int> <int> <int> <fct>       <fct>      #> 1 C1       198    64     3       8    11    18 3_9         63_1       #> 2 C2       198    64     3       8    11    18 3_9         63_1       #> 3 C3       198    64     3       8    11    18 3_9         63_1       #> 4 C4       198    64     3       8    11    18 3_9         63_1       #> 5 C5       198    64     3       8    11    18 3_9         63_1       #> 6 C6       198    64     3       8    11    18 3_9         63_1       #>  #> --------------------------------------------------------------------- #> Connectivity Matrix: #> --------------------------------------------------------------------- #>    C1 C2 C3 C4 C5 C6 #> C1 64 64 64 64 64 64 #> C2 64 64 64 64 64 64 #> C3 64 64 64 64 64 64 #> C4 64 64 64 64 64 64 #> C5 64 64 64 64 64 64 #> C6 64 64 64 64 64 64 #>  #> --------------------------------------------------------------------- #> Filters Applied: #> --------------------------------------------------------------------- #> List of 1 #>  $ yield:List of 4 #>   ..$ missing_50%     : chr(0)  #>   ..$ no_variation    : chr(0)  #>   ..$ row_col_dup     : chr(0)  #>   ..$ trials_to_remove: chr(0)"},{"path":"https://apariciojohan.github.io/agriutilities/articles/how-to-start.html","id":"single-trial-analysis","dir":"Articles","previous_headings":"","what":"Single Trial Analysis","title":"How to Start","text":"results previous function used single_trial_analysis() fit single trial models.","code":"obj <- single_trial_analysis(results, progress = FALSE) print(obj) #> --------------------------------------------------------------------- #> Summary Fitted Models: #> --------------------------------------------------------------------- #>    trait trial heritability        CV    VarGen    VarErr  design #> 1: yield    C1         0.73  6.022489  87.39848  82.86095 row_col #> 2: yield    C2         0.37 17.104998  25.80684 108.68546 row_col #> 3: yield    C3         0.64 12.357202  83.57907 118.55567 row_col #> 4: yield    C4         0.41  8.179408  35.75568 136.21218 row_col #> 5: yield    C5         0.80  7.037586 103.79822  66.97523 row_col #> 6: yield    C6         0.49 16.632367  71.92232 207.53073 row_col #>  #> --------------------------------------------------------------------- #> Outliers Removed: #> --------------------------------------------------------------------- #>    trait trial genotype id outlier #> 1: yield    C1      G60 50    TRUE #>  #> --------------------------------------------------------------------- #> First Predicted Values and Standard Errors (BLUEs/BLUPs): #> --------------------------------------------------------------------- #>    trait genotype trial    BLUEs  seBLUEs    BLUPs  seBLUPs         wt #> 1: yield      G01    C1 141.4161 6.078858 143.5308 5.249771 0.02706176 #> 2: yield      G02    C1 157.8110 5.979708 155.8037 5.194547 0.02796663 #> 3: yield      G03    C1 127.3836 6.091534 133.0256 5.269999 0.02694925 #> 4: yield      G04    C1 154.8445 6.093866 153.8364 5.270427 0.02692863 #> 5: yield      G05    C1 163.8950 6.132141 161.1831 5.271809 0.02659352 #> 6: yield      G06    C1 128.5168 6.087902 133.6857 5.247130 0.02698141"},{"path":"https://apariciojohan.github.io/agriutilities/articles/how-to-start.html","id":"multi-environmental-trial-analysis","dir":"Articles","previous_headings":"","what":"Multi-Environmental Trial Analysis","title":"How to Start","text":"results previous function used met_analysis() fit multi-environmental trial models.","code":"met_results <- met_analysis(obj) #> Online License checked out Mon Feb 13 09:11:12 2023 #> Fitting MET model for yield. #> Online License checked out Mon Feb 13 09:11:13 2023 print(met_results) #> --------------------------------------------------------------------- #> Trial Effects (BLUEs): #> --------------------------------------------------------------------- #>   trait trial predicted.value std.error    status #> 1 yield    C1       149.74946  1.358117 Estimable #> 2 yield    C2        65.99561  1.141995 Estimable #> 3 yield    C3        90.60825  1.449096 Estimable #> 4 yield    C4       148.12392  1.202934 Estimable #> 5 yield    C5       121.77612  1.429239 Estimable #> 6 yield    C6        88.31194  1.532688 Estimable #>  #> --------------------------------------------------------------------- #> Heritability: #> --------------------------------------------------------------------- #>   trait        h2 #> 1 yield 0.8239191 #>  #> --------------------------------------------------------------------- #> First Overall Predicted Values and Standard Errors (BLUPs): #> --------------------------------------------------------------------- #>   trait genotype predicted.value std.error    status #> 1 yield      G01        110.4297  2.528111 Estimable #> 2 yield      G02        110.8617  2.537200 Estimable #> 3 yield      G03        102.6812  2.541066 Estimable #> 4 yield      G04        115.4946  2.533730 Estimable #> 5 yield      G05        120.6600  2.548344 Estimable #> 6 yield      G06        108.8297  2.555281 Estimable #>  #> --------------------------------------------------------------------- #> Variance-Covariance Matrix: #> --------------------------------------------------------------------- #>  #> Correlation Matrix ('us'): yield #>      C1   C2   C3   C4   C5   C6 #> C1 1.00 0.57 0.58 0.65 0.95 0.43 #> C2 0.57 1.00 0.55 0.70 0.52 0.76 #> C3 0.58 0.55 1.00 0.95 0.72 0.27 #> C4 0.65 0.70 0.95 1.00 0.75 0.47 #> C5 0.95 0.52 0.72 0.75 1.00 0.33 #> C6 0.43 0.76 0.27 0.47 0.33 1.00 #>  #> Covariance Matrix ('us'): yield #>       C1    C2    C3    C4     C5    C6 #> C1 80.57 27.36 46.81 31.67  85.61 31.17 #> C2 27.36 28.90 26.44 20.41  27.99 33.51 #> C3 46.81 26.44 79.66 45.84  64.54 19.81 #> C4 31.67 20.41 45.84 29.28  40.79 20.76 #> C5 85.61 27.99 64.54 40.79 100.60 27.13 #> C6 31.17 33.51 19.81 20.76  27.13 66.66 #>  #> --------------------------------------------------------------------- #> First Stability Coefficients: #> --------------------------------------------------------------------- #>   trait genotype superiority   static    wricke predicted.value #> 1 yield      G57    22.67503 32.45871 13.962970        92.45997 #> 2 yield      G29    17.27533 34.41794  4.343501        99.38429 #> 3 yield      G34    17.26249 33.29276  8.514332        99.74688 #> 4 yield      G59    16.94882 34.39425  4.798863        99.87221 #> 5 yield      G31    16.23001 31.89042 11.722935       101.66382 #> 6 yield      G10    15.75253 32.02994 11.499867       102.39802"},{"path":"https://apariciojohan.github.io/agriutilities/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Johan Aparicio. Author, maintainer. Alexia Bornhorst. Author. Alliance Bioversity International CIAT. Copyright holder.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Aparicio J, Bornhorst (2023). agriutilities: Utilities Data Analysis Agriculture. https://github.com/AparicioJohan/agriutilities, https://apariciojohan.github.io/agriutilities/.","code":"@Manual{,   title = {agriutilities: Utilities for Data Analysis in Agriculture},   author = {Johan Aparicio and Alexia Bornhorst},   year = {2023},   note = {https://github.com/AparicioJohan/agriutilities, https://apariciojohan.github.io/agriutilities/}, }"},{"path":[]},{"path":"https://apariciojohan.github.io/agriutilities/CODE_OF_CONDUCT.html","id":"our-pledge","dir":"","previous_headings":"","what":"Our Pledge","title":"Contributor Covenant Code of Conduct","text":"members, contributors, leaders pledge make participation community harassment-free experience everyone, regardless age, body size, visible invisible disability, ethnicity, sex characteristics, gender identity expression, level experience, education, socio-economic status, nationality, personal appearance, race, caste, color, religion, sexual identity orientation. pledge act interact ways contribute open, welcoming, diverse, inclusive, healthy community.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/CODE_OF_CONDUCT.html","id":"our-standards","dir":"","previous_headings":"","what":"Our Standards","title":"Contributor Covenant Code of Conduct","text":"Examples behavior contributes positive environment community include: Demonstrating empathy kindness toward people respectful differing opinions, viewpoints, experiences Giving gracefully accepting constructive feedback Accepting responsibility apologizing affected mistakes, learning experience Focusing best just us individuals, overall community Examples unacceptable behavior include: use sexualized language imagery, sexual attention advances kind Trolling, insulting derogatory comments, personal political attacks Public private harassment Publishing others’ private information, physical email address, without explicit permission conduct reasonably considered inappropriate professional setting","code":""},{"path":"https://apariciojohan.github.io/agriutilities/CODE_OF_CONDUCT.html","id":"enforcement-responsibilities","dir":"","previous_headings":"","what":"Enforcement Responsibilities","title":"Contributor Covenant Code of Conduct","text":"Community leaders responsible clarifying enforcing standards acceptable behavior take appropriate fair corrective action response behavior deem inappropriate, threatening, offensive, harmful. Community leaders right responsibility remove, edit, reject comments, commits, code, wiki edits, issues, contributions aligned Code Conduct, communicate reasons moderation decisions appropriate.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/CODE_OF_CONDUCT.html","id":"scope","dir":"","previous_headings":"","what":"Scope","title":"Contributor Covenant Code of Conduct","text":"Code Conduct applies within community spaces, also applies individual officially representing community public spaces. Examples representing community include using official e-mail address, posting via official social media account, acting appointed representative online offline event.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/CODE_OF_CONDUCT.html","id":"enforcement","dir":"","previous_headings":"","what":"Enforcement","title":"Contributor Covenant Code of Conduct","text":"Instances abusive, harassing, otherwise unacceptable behavior may reported community leaders responsible enforcement johanstevenapa@gmail.com. complaints reviewed investigated promptly fairly. community leaders obligated respect privacy security reporter incident.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/CODE_OF_CONDUCT.html","id":"enforcement-guidelines","dir":"","previous_headings":"","what":"Enforcement Guidelines","title":"Contributor Covenant Code of Conduct","text":"Community leaders follow Community Impact Guidelines determining consequences action deem violation Code Conduct:","code":""},{"path":"https://apariciojohan.github.io/agriutilities/CODE_OF_CONDUCT.html","id":"1-correction","dir":"","previous_headings":"Enforcement Guidelines","what":"1. Correction","title":"Contributor Covenant Code of Conduct","text":"Community Impact: Use inappropriate language behavior deemed unprofessional unwelcome community. Consequence: private, written warning community leaders, providing clarity around nature violation explanation behavior inappropriate. public apology may requested.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/CODE_OF_CONDUCT.html","id":"2-warning","dir":"","previous_headings":"Enforcement Guidelines","what":"2. Warning","title":"Contributor Covenant Code of Conduct","text":"Community Impact: violation single incident series actions. Consequence: warning consequences continued behavior. interaction people involved, including unsolicited interaction enforcing Code Conduct, specified period time. includes avoiding interactions community spaces well external channels like social media. Violating terms may lead temporary permanent ban.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/CODE_OF_CONDUCT.html","id":"3-temporary-ban","dir":"","previous_headings":"Enforcement Guidelines","what":"3. Temporary Ban","title":"Contributor Covenant Code of Conduct","text":"Community Impact: serious violation community standards, including sustained inappropriate behavior. Consequence: temporary ban sort interaction public communication community specified period time. public private interaction people involved, including unsolicited interaction enforcing Code Conduct, allowed period. Violating terms may lead permanent ban.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/CODE_OF_CONDUCT.html","id":"4-permanent-ban","dir":"","previous_headings":"Enforcement Guidelines","what":"4. Permanent Ban","title":"Contributor Covenant Code of Conduct","text":"Community Impact: Demonstrating pattern violation community standards, including sustained inappropriate behavior, harassment individual, aggression toward disparagement classes individuals. Consequence: permanent ban sort public interaction within community.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/CODE_OF_CONDUCT.html","id":"attribution","dir":"","previous_headings":"","what":"Attribution","title":"Contributor Covenant Code of Conduct","text":"Code Conduct adapted Contributor Covenant, version 2.1, available https://www.contributor-covenant.org/version/2/1/code_of_conduct.html. Community Impact Guidelines inspired [Mozilla’s code conduct enforcement ladder][https://github.com/mozilla/inclusion]. answers common questions code conduct, see FAQ https://www.contributor-covenant.org/faq. Translations available https://www.contributor-covenant.org/translations.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/index.html","id":"agriutilities-","dir":"","previous_headings":"","what":"Utilities for Data Analysis in Agriculture","title":"Utilities for Data Analysis in Agriculture","text":"agriutilities R package designed make analysis field trials easier accessible everyone working plant breeding. provides simple intuitive interface conducting single multi-environmental trial analysis, minimal coding required. Whether ’re beginner experienced user, agriutilities help quickly easily carry complex analyses confidence. built-functions fitting Linear Mixed Models (LMM), agriutilities ideal choice anyone wants save time focus interpreting results.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Utilities for Data Analysis in Agriculture","text":"can install development version agriutilities GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"AparicioJohan/agriutilities\")"},{"path":"https://apariciojohan.github.io/agriutilities/index.html","id":"automatic-data-analysis-pipeline","dir":"","previous_headings":"","what":"Automatic Data Analysis Pipeline","title":"Utilities for Data Analysis in Agriculture","text":"basic example shows use functions package.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/index.html","id":"identify-the-experimental-design","dir":"","previous_headings":"Automatic Data Analysis Pipeline","what":"Identify the Experimental Design","title":"Utilities for Data Analysis in Agriculture","text":"function check_design_met helps us check quality data also identify experimental design trials. works quality check quality control fit model.","code":"library(agriutilities) library(agridat) data(besag.met) dat <- besag.met results <- check_design_met(   data = dat,   genotype = \"gen\",   trial = \"county\",   traits = \"yield\",   rep = \"rep\",   block = \"block\",   col = \"col\",   row = \"row\" )"},{"path":"https://apariciojohan.github.io/agriutilities/index.html","id":"single-trial-analysis-sta","dir":"","previous_headings":"Automatic Data Analysis Pipeline","what":"Single Trial Analysis (STA)","title":"Utilities for Data Analysis in Agriculture","text":"results previous function used single_trial_analysis() fit single trial models. function can fit, Completely Randomized Designs (CRD), Randomized Complete Block Designs (RCBD), Resolvable Incomplete Block Designs (res-IBD), Non-Resolvable Row-Column Designs (Row-Col) Resolvable Row-Column Designs (res-Row-Col). NOTE: fits models based randomization detected. returning object set lists trial summary, BLUEs, BLUPs, heritability, variance components, potential extreme observations, residuals, models fitted data used.","code":"obj <- single_trial_analysis(results, progress = FALSE)"},{"path":"https://apariciojohan.github.io/agriutilities/index.html","id":"two-stage-analysis-met","dir":"","previous_headings":"Automatic Data Analysis Pipeline","what":"Two-Stage Analysis (MET)","title":"Utilities for Data Analysis in Agriculture","text":"results previous function used met_analysis() fit multi-environmental trial models.","code":"met_results <- met_analysis(obj, progress = FALSE) Online License checked out Mon Feb 13 09:09:21 2023 Online License checked out Mon Feb 13 09:09:22 2023"},{"path":"https://apariciojohan.github.io/agriutilities/index.html","id":"inspect-the-outputs","dir":"","previous_headings":"Automatic Data Analysis Pipeline","what":"Inspect the Outputs","title":"Utilities for Data Analysis in Agriculture","text":"","code":"print(results) --------------------------------------------------------------------- Summary Traits by Trial: --------------------------------------------------------------------- # A tibble: 6 x 9   county traits  Mean Median    SD    CV     n n_miss miss_perc   <fct>  <chr>  <dbl>  <dbl> <dbl> <dbl> <int>  <int>     <dbl> 1 C1     yield  149.   151.   17.7 0.119   198      6    0.0303 2 C2     yield   56.1   52.1  18.4 0.328   198      6    0.0303 3 C3     yield   87.9   89.2  19.7 0.225   198      6    0.0303 4 C4     yield  145.   143.   17.1 0.118   198      6    0.0303 5 C5     yield  115.   116.   16.4 0.142   198      6    0.0303 6 C6     yield   87.6   87.8  26.6 0.304   198      6    0.0303  --------------------------------------------------------------------- Experimental Design Detected: ---------------------------------------------------------------------   county exp_design 1     C1    row_col 2     C2    row_col 3     C3    row_col 4     C4    row_col 5     C5    row_col 6     C6    row_col  --------------------------------------------------------------------- Summary Experimental Design: --------------------------------------------------------------------- # A tibble: 6 x 9   county     n n_gen n_rep n_block n_col n_row num_of_reps num_of_gen   <fct>  <int> <int> <int>   <int> <int> <int> <fct>       <fct>      1 C1       198    64     3       8    11    18 3_9         63_1       2 C2       198    64     3       8    11    18 3_9         63_1       3 C3       198    64     3       8    11    18 3_9         63_1       4 C4       198    64     3       8    11    18 3_9         63_1       5 C5       198    64     3       8    11    18 3_9         63_1       6 C6       198    64     3       8    11    18 3_9         63_1        --------------------------------------------------------------------- Connectivity Matrix: ---------------------------------------------------------------------    C1 C2 C3 C4 C5 C6 C1 64 64 64 64 64 64 C2 64 64 64 64 64 64 C3 64 64 64 64 64 64 C4 64 64 64 64 64 64 C5 64 64 64 64 64 64 C6 64 64 64 64 64 64  --------------------------------------------------------------------- Filters Applied: --------------------------------------------------------------------- List of 1  $ yield:List of 4   ..$ missing_50%     : chr(0)    ..$ no_variation    : chr(0)    ..$ row_col_dup     : chr(0)    ..$ trials_to_remove: chr(0) print(obj) --------------------------------------------------------------------- Summary Fitted Models: ---------------------------------------------------------------------    trait trial heritability        CV    VarGen    VarErr  design 1: yield    C1         0.73  6.022489  87.39848  82.86095 row_col 2: yield    C2         0.37 17.104998  25.80684 108.68546 row_col 3: yield    C3         0.64 12.357202  83.57907 118.55567 row_col 4: yield    C4         0.41  8.179408  35.75568 136.21218 row_col 5: yield    C5         0.80  7.037586 103.79822  66.97523 row_col 6: yield    C6         0.49 16.632367  71.92232 207.53073 row_col  --------------------------------------------------------------------- Outliers Removed: ---------------------------------------------------------------------    trait trial genotype id outlier 1: yield    C1      G60 50    TRUE  --------------------------------------------------------------------- First Predicted Values and Standard Errors (BLUEs/BLUPs): ---------------------------------------------------------------------    trait genotype trial    BLUEs  seBLUEs    BLUPs  seBLUPs         wt 1: yield      G01    C1 141.4161 6.078858 143.5308 5.249771 0.02706176 2: yield      G02    C1 157.8110 5.979708 155.8037 5.194547 0.02796663 3: yield      G03    C1 127.3836 6.091534 133.0256 5.269999 0.02694925 4: yield      G04    C1 154.8445 6.093866 153.8364 5.270427 0.02692863 5: yield      G05    C1 163.8950 6.132141 161.1831 5.271809 0.02659352 6: yield      G06    C1 128.5168 6.087902 133.6857 5.247130 0.02698141 print(met_results) --------------------------------------------------------------------- Trial Effects (BLUEs): ---------------------------------------------------------------------   trait trial predicted.value std.error    status 1 yield    C1       149.74946  1.358117 Estimable 2 yield    C2        65.99561  1.141995 Estimable 3 yield    C3        90.60825  1.449096 Estimable 4 yield    C4       148.12392  1.202934 Estimable 5 yield    C5       121.77612  1.429239 Estimable 6 yield    C6        88.31194  1.532688 Estimable  --------------------------------------------------------------------- Heritability: ---------------------------------------------------------------------   trait        h2 1 yield 0.8239191  --------------------------------------------------------------------- First Overall Predicted Values and Standard Errors (BLUPs): ---------------------------------------------------------------------   trait genotype predicted.value std.error    status 1 yield      G01        110.4297  2.528111 Estimable 2 yield      G02        110.8617  2.537200 Estimable 3 yield      G03        102.6812  2.541066 Estimable 4 yield      G04        115.4946  2.533730 Estimable 5 yield      G05        120.6600  2.548344 Estimable 6 yield      G06        108.8297  2.555281 Estimable  --------------------------------------------------------------------- Variance-Covariance Matrix: ---------------------------------------------------------------------  Correlation Matrix ('us'): yield      C1   C2   C3   C4   C5   C6 C1 1.00 0.57 0.58 0.65 0.95 0.43 C2 0.57 1.00 0.55 0.70 0.52 0.76 C3 0.58 0.55 1.00 0.95 0.72 0.27 C4 0.65 0.70 0.95 1.00 0.75 0.47 C5 0.95 0.52 0.72 0.75 1.00 0.33 C6 0.43 0.76 0.27 0.47 0.33 1.00  Covariance Matrix ('us'): yield       C1    C2    C3    C4     C5    C6 C1 80.57 27.36 46.81 31.67  85.61 31.17 C2 27.36 28.90 26.44 20.41  27.99 33.51 C3 46.81 26.44 79.66 45.84  64.54 19.81 C4 31.67 20.41 45.84 29.28  40.79 20.76 C5 85.61 27.99 64.54 40.79 100.60 27.13 C6 31.17 33.51 19.81 20.76  27.13 66.66  --------------------------------------------------------------------- First Stability Coefficients: ---------------------------------------------------------------------   trait genotype superiority   static    wricke predicted.value 1 yield      G57    22.67503 32.45871 13.962970        92.45997 2 yield      G29    17.27533 34.41794  4.343501        99.38429 3 yield      G34    17.26249 33.29276  8.514332        99.74688 4 yield      G59    16.94882 34.39425  4.798863        99.87221 5 yield      G31    16.23001 31.89042 11.722935       101.66382 6 yield      G10    15.75253 32.02994 11.499867       102.39802"},{"path":"https://apariciojohan.github.io/agriutilities/index.html","id":"code-of-conduct","dir":"","previous_headings":"","what":"Code of Conduct","title":"Utilities for Data Analysis in Agriculture","text":"Please note agriutilities project released Contributor Code Conduct. contributing project, agree abide terms.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2023 agriutilities authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/check_connectivity.html","id":null,"dir":"Reference","previous_headings":"","what":"Check connectivity between trials — check_connectivity","title":"Check connectivity between trials — check_connectivity","text":"Check connectivity trials","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/check_connectivity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check connectivity between trials — check_connectivity","text":"","code":"check_connectivity(   data = NULL,   genotype = \"line\",   trial = \"Experiment\",   response = NULL,   all = FALSE,   return_matrix = FALSE )"},{"path":"https://apariciojohan.github.io/agriutilities/reference/check_connectivity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check connectivity between trials — check_connectivity","text":"data data.frame wide format. genotype character string indicating column data contains genotypes. trial character string indicating column data contains trials. response character string specifying trait. Whether print table. return_matrix logical value indicating user wants return (n_trial x n_trial) matrix amount genotypes shared pair trial. (FALSE default)","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/check_connectivity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check connectivity between trials — check_connectivity","text":"data.frame genotype connectivity. return_matrix TRUE, return n_trial x n_trial matrix amount genotypes shared pair trial.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/check_connectivity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check connectivity between trials — check_connectivity","text":"","code":"library(agridat) #> Warning: package 'agridat' was built under R version 4.1.3 library(agriutilities) data(besag.met) dat <- besag.met head(   check_connectivity(     data = dat,     genotype = \"gen\",     trial = \"county\",     response = \"yield\",     all = TRUE,     return_matrix = FALSE   ) ) #>   gen C1 C2 C3 C4 C5 C6 total n percent #> 1 G01  1  1  1  1  1  1     6 6       1 #> 2 G02  1  1  1  1  1  1     6 6       1 #> 3 G03  1  1  1  1  1  1     6 6       1 #> 4 G04  1  1  1  1  1  1     6 6       1 #> 5 G05  1  1  1  1  1  1     6 6       1 #> 6 G06  1  1  1  1  1  1     6 6       1"},{"path":"https://apariciojohan.github.io/agriutilities/reference/check_design_met.html","id":null,"dir":"Reference","previous_headings":"","what":"Check Experimental Design — check_design_met","title":"Check Experimental Design — check_design_met","text":"function helps identify experimental design trial, filters data provide summary traits experimental design. works quality check fit model. Returns object class checkAgri.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/check_design_met.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check Experimental Design — check_design_met","text":"","code":"check_design_met(   data = NULL,   genotype = NULL,   trial = NULL,   traits = NULL,   rep = NULL,   block = NULL,   row = NULL,   col = NULL )"},{"path":"https://apariciojohan.github.io/agriutilities/reference/check_design_met.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check Experimental Design — check_design_met","text":"data data.frame wide format. genotype character string indicating column data contains genotypes. trial character string indicating column data contains trials. traits character vector specifying traits models fitted. rep character string indicating column data contains replicates. block character string indicating column data contains sub blocks. row character string indicating column data contains row coordinates. col character string indicating column data contains column coordinates.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/check_design_met.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check Experimental Design — check_design_met","text":"object class checkAgri, list : summ_traits data.frame containing summary traits. exp_design_resum data.frame containing summary experimental  design. filter list trait containing filtered trials. exp_design_list data.frame containing experimental design trial. check_connectivity data.frame genotype connectivity. connectivity_matrix matrix amount genotypes shared pair trial. data_design data frame containing data used two additional columns, one realted experimental design sequential number (id) inputs list containing character string indicates column data contains genotype, trial, traits, rep, block, row col.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/check_design_met.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check Experimental Design — check_design_met","text":"","code":"library(agridat) library(agriutilities) data(besag.met) dat <- besag.met results <- check_design_met(   data = dat,   genotype = \"gen\",   trial = \"county\",   traits = c(\"yield\"),   rep = \"rep\",   block = \"block\",   col = \"col\",   row = \"row\" ) print(results) #> --------------------------------------------------------------------- #> Summary Traits by Trial: #> --------------------------------------------------------------------- #> # A tibble: 6 x 9 #>   county traits  Mean Median    SD    CV     n n_miss miss_perc #>   <fct>  <chr>  <dbl>  <dbl> <dbl> <dbl> <int>  <int>     <dbl> #> 1 C1     yield  149.   151.   17.7 0.119   198      6    0.0303 #> 2 C2     yield   56.1   52.1  18.4 0.328   198      6    0.0303 #> 3 C3     yield   87.9   89.2  19.7 0.225   198      6    0.0303 #> 4 C4     yield  145.   143.   17.1 0.118   198      6    0.0303 #> 5 C5     yield  115.   116.   16.4 0.142   198      6    0.0303 #> 6 C6     yield   87.6   87.8  26.6 0.304   198      6    0.0303 #>  #> --------------------------------------------------------------------- #> Experimental Design Detected: #> --------------------------------------------------------------------- #>   county exp_design #> 1     C1    row_col #> 2     C2    row_col #> 3     C3    row_col #> 4     C4    row_col #> 5     C5    row_col #> 6     C6    row_col #>  #> --------------------------------------------------------------------- #> Summary Experimental Design: #> --------------------------------------------------------------------- #> # A tibble: 6 x 9 #>   county     n n_gen n_rep n_block n_col n_row num_of_reps num_of_gen #>   <fct>  <int> <int> <int>   <int> <int> <int> <fct>       <fct>      #> 1 C1       198    64     3       8    11    18 3_9         63_1       #> 2 C2       198    64     3       8    11    18 3_9         63_1       #> 3 C3       198    64     3       8    11    18 3_9         63_1       #> 4 C4       198    64     3       8    11    18 3_9         63_1       #> 5 C5       198    64     3       8    11    18 3_9         63_1       #> 6 C6       198    64     3       8    11    18 3_9         63_1       #>  #> --------------------------------------------------------------------- #> Connectivity Matrix: #> --------------------------------------------------------------------- #>    C1 C2 C3 C4 C5 C6 #> C1 64 64 64 64 64 64 #> C2 64 64 64 64 64 64 #> C3 64 64 64 64 64 64 #> C4 64 64 64 64 64 64 #> C5 64 64 64 64 64 64 #> C6 64 64 64 64 64 64 #>  #> --------------------------------------------------------------------- #> Filters Applied: #> --------------------------------------------------------------------- #> List of 1 #>  $ yield:List of 4 #>   ..$ missing_50%     : chr(0)  #>   ..$ no_variation    : chr(0)  #>   ..$ row_col_dup     : chr(0)  #>   ..$ trials_to_remove: chr(0)  #>  plot(results, type = \"connectivity\")  plot(results, type = \"missing\")"},{"path":"https://apariciojohan.github.io/agriutilities/reference/check_design_met_1.html","id":null,"dir":"Reference","previous_headings":"","what":"Check Experimental Design — check_design_met_1","title":"Check Experimental Design — check_design_met_1","text":"function helps identify experimental design trial, filters data provide summary traits experimental design. works quality check fit model. Returns object class checkAgri.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/check_design_met_1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check Experimental Design — check_design_met_1","text":"","code":"check_design_met_1(   data = NULL,   genotype = NULL,   trial = NULL,   traits = NULL,   rep = NULL,   block = NULL,   row = NULL,   col = NULL )"},{"path":"https://apariciojohan.github.io/agriutilities/reference/check_design_met_1.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check Experimental Design — check_design_met_1","text":"data data.frame wide format. genotype character string indicating column data contains genotypes. trial character string indicating column data contains trials. traits character vector specifying traits models fitted. rep character string indicating column data contains replicates. block character string indicating column data contains sub blocks. row character string indicating column data contains row coordinates. col character string indicating column data contains column coordinates.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/check_design_met_1.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check Experimental Design — check_design_met_1","text":"object class checkAgri, list : summ_traits data.frame containing summary traits. exp_design_resum data.frame containing summary experimental  design. filter list trait containing filtered trials. exp_design_list data.frame containing experimental design trial. check_connectivity data.frame genotype connectivity. connectivity_matrix matrix amount genotypes shared pair trial. data_design data frame containing data used two additional columns, one realted experimental design sequential number (id) inputs list containing character string indicates column data contains genotype, trial, traits, rep, block, row col.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/check_design_met_1.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check Experimental Design — check_design_met_1","text":"","code":"# \\donttest{ library(agridat) library(agriutilities) data(besag.met) dat <- besag.met results <- check_design_met_1(   data = dat,   genotype = \"gen\",   trial = \"county\",   traits = c(\"yield\"),   rep = \"rep\",   block = \"block\",   col = \"col\",   row = \"row\" ) print(results) #> --------------------------------------------------------------------- #> Summary Traits by Trial: #> --------------------------------------------------------------------- #> # A tibble: 6 x 9 #>   county traits  Mean Median    SD    CV     n n_miss miss_perc #>   <fct>  <chr>  <dbl>  <dbl> <dbl> <dbl> <int>  <int>     <dbl> #> 1 C1     yield  149.   151.   17.7 0.119   198      6    0.0303 #> 2 C2     yield   56.1   52.1  18.4 0.328   198      6    0.0303 #> 3 C3     yield   87.9   89.2  19.7 0.225   198      6    0.0303 #> 4 C4     yield  145.   143.   17.1 0.118   198      6    0.0303 #> 5 C5     yield  115.   116.   16.4 0.142   198      6    0.0303 #> 6 C6     yield   87.6   87.8  26.6 0.304   198      6    0.0303 #>  #> --------------------------------------------------------------------- #> Experimental Design Detected: #> --------------------------------------------------------------------- #>   county exp_design #> 1     C1    row_col #> 2     C2    row_col #> 3     C3    row_col #> 4     C4    row_col #> 5     C5    row_col #> 6     C6    row_col #>  #> --------------------------------------------------------------------- #> Summary Experimental Design: #> --------------------------------------------------------------------- #> # A tibble: 6 x 9 #>   county     n n_gen n_rep n_block n_col n_row num_of_reps num_of_gen #>   <fct>  <int> <int> <int>   <int> <int> <int> <fct>       <fct>      #> 1 C1       198    64     3       8    11    18 3_9         63_1       #> 2 C2       198    64     3       8    11    18 3_9         63_1       #> 3 C3       198    64     3       8    11    18 3_9         63_1       #> 4 C4       198    64     3       8    11    18 3_9         63_1       #> 5 C5       198    64     3       8    11    18 3_9         63_1       #> 6 C6       198    64     3       8    11    18 3_9         63_1       #>  #> --------------------------------------------------------------------- #> Connectivity Matrix: #> --------------------------------------------------------------------- #>    C1 C2 C3 C4 C5 C6 #> C1 64 64 64 64 64 64 #> C2 64 64 64 64 64 64 #> C3 64 64 64 64 64 64 #> C4 64 64 64 64 64 64 #> C5 64 64 64 64 64 64 #> C6 64 64 64 64 64 64 #>  #> --------------------------------------------------------------------- #> Filters Applied: #> --------------------------------------------------------------------- #> List of 1 #>  $ yield:List of 4 #>   ..$ missing_50%     : chr(0)  #>   ..$ no_variation    : chr(0)  #>   ..$ row_col_dup     : chr(0)  #>   ..$ trials_to_remove: chr(0)  #>  # Plotting Connectivity Matrix plot(results, type = \"connectivity\")  # Plotting Missing Data plot(results, type = \"missing\")  # }"},{"path":"https://apariciojohan.github.io/agriutilities/reference/connectivity_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Connectivity Matrix — connectivity_matrix","title":"Connectivity Matrix — connectivity_matrix","text":"Check amount genotypes shared pair trial.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/connectivity_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Connectivity Matrix — connectivity_matrix","text":"","code":"connectivity_matrix(   data = NULL,   genotype = \"germplasmName\",   trial = \"trial\",   response = NULL )"},{"path":"https://apariciojohan.github.io/agriutilities/reference/connectivity_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Connectivity Matrix — connectivity_matrix","text":"data data.frame wide format. genotype character string indicating column data contains genotypes. trial character string indicating column data contains trials. response character string specifying trait.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/connectivity_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Connectivity Matrix — connectivity_matrix","text":"function generates (n_trial x n_trial) matrix amount genotypes shared pair trial.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/connectivity_matrix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Connectivity Matrix — connectivity_matrix","text":"","code":"# \\donttest{ library(agridat) data(besag.met) dat <- besag.met connectivity_matrix(   data = dat,   genotype = \"gen\",   trial = \"county\",   response = \"yield\" ) #>    C1 C2 C3 C4 C5 C6 #> C1 64 64 64 64 64 64 #> C2 64 64 64 64 64 64 #> C3 64 64 64 64 64 64 #> C4 64 64 64 64 64 64 #> C5 64 64 64 64 64 64 #> C6 64 64 64 64 64 64 # }"},{"path":"https://apariciojohan.github.io/agriutilities/reference/covcor_heat.html","id":null,"dir":"Reference","previous_headings":"","what":"Correlation Covariance Heatmap — covcor_heat","title":"Correlation Covariance Heatmap — covcor_heat","text":"Correlation Covariance Heatmap","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/covcor_heat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Correlation Covariance Heatmap — covcor_heat","text":"","code":"covcor_heat(matrix, corr = TRUE, size = 4, digits = 3)"},{"path":"https://apariciojohan.github.io/agriutilities/reference/covcor_heat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Correlation Covariance Heatmap — covcor_heat","text":"matrix numeric matrix. corr logical value indicating matrix scaled form (TRUE default, correlation matrix) size numeric value define letter size. digits numeric integer define number digits plot.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/covcor_heat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Correlation Covariance Heatmap — covcor_heat","text":"ggplot object showing upper triangular elements matrix.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/covcor_heat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Correlation Covariance Heatmap — covcor_heat","text":"","code":"library(agriutilities) data(iris) M <- cor(iris[, -5]) covcor_heat(matrix = M, corr = TRUE)"},{"path":"https://apariciojohan.github.io/agriutilities/reference/extract_vcov.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Variance-Covariance from ASReml-R — extract_vcov","title":"Extract Variance-Covariance from ASReml-R — extract_vcov","text":"Extract Variance-Covariance ASReml-R","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/extract_vcov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Variance-Covariance from ASReml-R — extract_vcov","text":"","code":"extract_vcov(model = NULL, gen = \"genotype\", env = \"trial\", vc_model = \"corv\")"},{"path":"https://apariciojohan.github.io/agriutilities/reference/extract_vcov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Variance-Covariance from ASReml-R — extract_vcov","text":"model ASReml object gen character string indicating column data contains genotypes. env character string indicating column data contains environments trials. vc_model character string indicating variance-covariance fitted. Can 'diag', 'corv', 'corh', 'corgv', 'fa1', 'fa2', 'fa3', 'fa4', 'corgh', 'us' 'rr2'.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/extract_vcov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Variance-Covariance from ASReml-R — extract_vcov","text":"object list : VCOV matrix estimated variance-covariance trials. CORR n_trial x n_trial matrix correlation trials. vc_model character string indicating variance-covariance fitted.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/extract_vcov.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract Variance-Covariance from ASReml-R — extract_vcov","text":"","code":"# \\donttest{ library(agridat) library(agriutilities)  data(besag.met) dat <- besag.met results <- check_design_met(  data = dat,  genotype = \"gen\",  trial = \"county\",  traits = c(\"yield\"),  rep = \"rep\",  block = \"block\",  col = \"col\",  row = \"row\" ) out <- single_trial_analysis(results, progress = FALSE) met_results <- met_analysis(out, progress = FALSE) #> Online License checked out Mon Feb 13 09:10:29 2023 #> Online License checked out Mon Feb 13 09:10:30 2023 extract_vcov(  model = met_results$met_models$yield,  vc_model = \"us\" ) #> $VCOV #>          C1       C2       C3       C4        C5       C6 #> C1 80.57078 27.35631 46.80920 31.67095  85.61470 31.17032 #> C2 27.35631 28.90184 26.44403 20.40997  27.99220 33.50946 #> C3 46.80920 26.44403 79.66149 45.84374  64.53892 19.81346 #> C4 31.67095 20.40997 45.84374 29.28131  40.79469 20.75609 #> C5 85.61470 27.99220 64.53892 40.79469 100.59937 27.13428 #> C6 31.17032 33.50946 19.81346 20.75609  27.13428 66.66439 #>  #> $CORR #>           C1        C2        C3        C4        C5        C6 #> C1 1.0000000 0.5668993 0.5842762 0.6520442 0.9509593 0.4253099 #> C2 0.5668993 1.0000000 0.5511131 0.7015917 0.5191307 0.7634097 #> C3 0.5842762 0.5511131 1.0000000 0.9492062 0.7209412 0.2718875 #> C4 0.6520442 0.7015917 0.9492062 1.0000000 0.7516415 0.4697896 #> C5 0.9509593 0.5191307 0.7209412 0.7516415 1.0000000 0.3313399 #> C6 0.4253099 0.7634097 0.2718875 0.4697896 0.3313399 1.0000000 #>  #> $vc_model #> [1] \"us\" #>  # }"},{"path":"https://apariciojohan.github.io/agriutilities/reference/fa2_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Factor Analytic Summary — fa2_summary","title":"Factor Analytic Summary — fa2_summary","text":"Factor Analytic Summary","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/fa2_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Factor Analytic Summary — fa2_summary","text":"","code":"fa2_summary(   model = NULL,   trial = \"trial\",   genotype = \"genotype\",   BLUEs_trial = NULL,   mult_fa1 = -1,   mult_fa2 = 1,   filter_score = 1.5,   k_biplot = 1,   size_label_var = 2,   alpha_label_var = 0.2,   size_label_ind = 2,   alpha_label_ind = 0.8,   size_arrow = 0.2,   alpha_arrow = 0.2,   base_size = 12 )"},{"path":"https://apariciojohan.github.io/agriutilities/reference/fa2_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Factor Analytic Summary — fa2_summary","text":"model factor analytic model (asreml object) trial string genotype string BLUEs_trial data.frame trial BLUEs mult_fa1 c(1,-1) (-1 default) mult_fa2 c(1,-1) (1 default) filter_score value filter genotypes distance origin k_biplot factor multiply scores biplot size_label_var double alpha_label_var (0,1) size_label_ind double alpha_label_ind (0,1) size_arrow double alpha_arrow (0,1) base_size double","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/fa2_summary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Factor Analytic Summary — fa2_summary","text":"list  loadings = L, loading_star, Gvar, Cmat, summary_loadings, paf_site, var_tot, scores, plots = list(loadings, biplot,  biplot_scaled,  loadings_c)","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/fa2_summary.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Factor Analytic Summary — fa2_summary","text":"","code":"# library(tidyverse) # library(asreml) # library(agridat) # data(besag.met) # dat <- besag.met # # dat <- dat %>% arrange(county) # model <- asreml(fixed = yield ~ 1 + county, #                 random = ~ fa(county, 2):gen + county:rep + diag(county):rep:block, #                 residual = ~ dsum(~ units | county), #                 data = dat, #                 na.action = list(x=\"include\",y=\"include\")) # # pp <- predict(model, classify = \"county\")$pvals # fa2_summary( #  model = model, #  trial = \"county\", #  genotype = \"gen\", #  BLUEs_trial = pp, #  mult_fa1 = -1, #  mult_fa2 = -1, #  filter_score = 1, #  k_biplot = 10, #  size_label_var = 3, #  alpha_label_var = 0.5, #  size_label_ind = 3, #  alpha_label_ind = 0.8, #  size_arrow = 0.2, #  alpha_arrow = 0.1 # )"},{"path":"https://apariciojohan.github.io/agriutilities/reference/fa_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Factor Analytic Summary — fa_summary","title":"Factor Analytic Summary — fa_summary","text":"Factor Analytic Summary","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/fa_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Factor Analytic Summary — fa_summary","text":"","code":"fa_summary(   model = NULL,   trial = \"trial\",   genotype = \"genotype\",   BLUEs_trial = NULL,   mult_fa1 = -1,   mult_fa2 = 1,   filter_score = 1.5,   k_biplot = 1,   size_label_var = 2,   alpha_label_var = 0.2,   size_label_ind = 2,   alpha_label_ind = 0.8,   size_arrow = 0.2,   alpha_arrow = 0.2,   base_size = 12 )"},{"path":"https://apariciojohan.github.io/agriutilities/reference/fa_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Factor Analytic Summary — fa_summary","text":"model Factor Analytic Model (ASReml object) trial character string indicating column data contains trials. genotype character string indicating column data contains genotypes. BLUEs_trial data.frame containing BLUEs trial. mult_fa1 constant multiply first loading. Must 1 -1. (-1 default) mult_fa2 constant multiply second loading. Must 1 -1. (1 default) filter_score numeric value filter genotypes distance origin. k_biplot numeric value multiply scores biplot. size_label_var numeric value define label size variables. alpha_label_var numeric value (0,1) define label variables. size_label_ind numeric value define label size individuals. alpha_label_ind numeric value (0,1) define label individuals. size_arrow numeric value define arrow size. alpha_arrow numeric value (0,1) define arrow. base_size numeric value define base size.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/fa_summary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Factor Analytic Summary — fa_summary","text":"object list : loadings data.frame containing first second loading  trial. loading_star data.frame containing first second loading rotated trial. Gvar matrix estimated variance-covariance trials. Cmat matrix correlation trials. summary_loading data.frame containing summary loadings. paf_site data.frame containing percentage variance explained  component trial. var_tot numeric value total variance. scores data.frame containing scores genotype. plots list different plots. Includes plot loadings,  biplot, biplot_scaled loadings_c.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/fa_summary.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Factor Analytic Summary — fa_summary","text":"","code":"# \\donttest{ library(agridat) library(agriutilities) data(besag.met) dat <- besag.met results <- check_design_met(   data = dat,   genotype = \"gen\",   trial = \"county\",   traits = c(\"yield\"),   rep = \"rep\",   block = \"block\",   col = \"col\",   row = \"row\" ) out <- single_trial_analysis(results, progress = FALSE) met_results <- met_analysis(out, vcov = \"fa2\", progress = FALSE)  pp <- met_results$trial_effects model <- met_results$met_models$yield fa_summary(   model = model,   trial = \"trial\",   genotype = \"genotype\",   BLUEs_trial = pp,   mult_fa1 = -1,   mult_fa2 = -1,   filter_score = 1,   k_biplot = 10,   size_label_var = 3,   alpha_label_var = 0.5,   size_label_ind = 3,   alpha_label_ind = 0.8,   size_arrow = 0.2,   alpha_arrow = 0.1 ) #> $loadings #>    fa1_loadings fa2_loadings #> C1     8.367225    0.0000000 #> C2     3.075230   -4.3908569 #> C3     6.394677   -2.0112454 #> C4     4.278622   -2.4366537 #> C5    10.054977    0.6540456 #> C6     3.077589   -4.6007432 #>  #> $loading_star #>        [,1]       [,2] #> C1 8.182846 -1.7468491 #> C2 3.924156  3.6520763 #> C3 6.673658  0.6318911 #> C4 4.693046  1.4896999 #> C5 9.696860 -2.7388390 #> C6 3.970282  3.8568450 #>  #> $Gvar #>          C1       C2       C3       C4        C5       C6 #> C1 80.38841 25.73114 53.50570 35.80019  84.13225 25.75088 #> C2 25.73114 28.73666 28.49619 23.85674  28.04954 29.66550 #> C3 53.50570 28.49619 78.96497 32.26112  62.98288 28.93341 #> C4 35.80019 23.85674 32.26112 24.53919  41.42777 24.37826 #> C5 84.13225 28.04954 62.98288 41.42777 101.53033 27.93599 #> C6 25.75088 29.66550 28.93341 24.37826  27.93599 66.56541 #>  #> $Cmat #>           C1        C2        C3        C4        C5        C6 #> C1 1.0000000 0.5353578 0.6715620 0.8060436 0.9312534 0.3520230 #> C2 0.5353578 1.0000000 0.5982069 0.8983858 0.5192897 0.6782803 #> C3 0.6715620 0.5982069 1.0000000 0.7328786 0.7034081 0.3990783 #> C4 0.8060436 0.8983858 0.7328786 1.0000000 0.8299721 0.6031818 #> C5 0.9312534 0.5192897 0.7034081 0.8299721 1.0000000 0.3398144 #> C6 0.3520230 0.6782803 0.3990783 0.6031818 0.3398144 1.0000000 #>  #> $summary_loadings #>   site      fa1        fa2        psi        Vg      BLUE fa1_scaled #> 1   C1 8.182846 -1.7468491 10.3779630  80.38841 149.75463  0.9126571 #> 2   C2 3.924156  3.6520763  0.0000000  28.73666  65.99443  0.7320287 #> 3   C3 6.673658  0.6318911 34.0279676  78.96497  90.60647  0.7510118 #> 4   C4 4.693046  1.4896999  0.2953006  24.53919 148.12551  0.9473811 #> 5   C5 9.696860 -2.7388390  0.0000000 101.53033 121.77655  0.9623504 #> 6   C6 3.970282  3.8568450 35.9270153  66.56541  88.31651  0.4866279 #>    fa2_scaled #> 1 -0.19483128 #> 2  0.68127379 #> 3  0.07110907 #> 4  0.30072440 #> 5 -0.27181199 #> 6  0.47272427 #>  #> $paf_site #>       fac_1     fac_2       all #> C1 83.29430  3.795923  87.09022 #> C2 53.58660 46.413397 100.00000 #> C3 56.40187  0.505650  56.90752 #> C4 89.75310  9.043517  98.79662 #> C5 92.61182  7.388176 100.00000 #> C6 23.68067 22.346823  46.02750 #>  #> $var_tot #> [1] 67.95 10.87 #>  #> $scores #>    Genotype          fa1          fa2 distance_orig Score #> 1       G01 -0.162907114  0.864333514    0.87955168     0 #> 2       G02  0.105626023 -0.083550661    0.13467579     0 #> 3       G03 -1.389037056  0.569069801    1.50108773     1 #> 4       G04  0.559582939  0.320816355    0.64502419     0 #> 5       G05  1.637220690 -0.628815915    1.75382469     1 #> 6       G06 -0.380823622  0.812640322    0.89744689     0 #> 7       G07 -0.001463806  0.028277859    0.02831572     0 #> 8       G08  1.185985249  0.330885059    1.23127817     1 #> 9       G09  1.153477549 -0.802887244    1.40539617     1 #> 10      G10 -1.379112088  0.742188138    1.56613964     1 #> 11      G11 -0.897839579  0.106862883    0.90417674     0 #> 12      G12 -1.221130723  0.002421723    1.22113312     1 #> 13      G13  0.221402119  1.004125762    1.02824484     1 #> 14      G14  0.138258700 -0.114499969    0.17951521     0 #> 15      G15  0.413043958 -0.673321409    0.78991584     0 #> 16      G16 -0.018263089  1.074588820    1.07474400     1 #> 17      G17  0.881967964  0.465522525    0.99728567     0 #> 18      G18 -0.752820119  0.280913277    0.80352374     0 #> 19      G19  0.319953496 -0.614844242    0.69311159     0 #> 20      G20  0.842230016 -0.948250406    1.26827845     1 #> 21      G21 -0.356159104 -0.705582727    0.79037731     0 #> 22      G22  0.704298528  0.262242826    0.75153690     0 #> 23      G23 -0.623360509 -0.545101814    0.82807869     0 #> 24      G24 -0.437087633  0.412328525    0.60088303     0 #> 25      G25  0.494439185 -0.782013670    0.92521105     0 #> 26      G26 -0.356243663 -1.107758555    1.16363163     1 #> 27      G27  0.261819733  0.939925968    0.97571020     0 #> 28      G28 -0.461004335 -0.614053253    0.76784529     0 #> 29      G29 -1.673325734 -0.762576155    1.83889679     1 #> 30      G30  1.204056560 -0.959280343    1.53947101     1 #> 31      G31 -1.499276278  0.110906249    1.50337273     1 #> 32      G32  1.230685960  0.402133956    1.29471991     1 #> 33      G33 -1.316040750  0.758089183    1.51877005     1 #> 34      G34 -1.625145019 -0.116754081    1.62933356     1 #> 35      G35  0.129254735 -0.094184492    0.15992969     0 #> 36      G36  0.728509114  0.915541387    1.17001776     1 #> 37      G37 -0.963154753 -0.390541381    1.03932173     1 #> 38      G38  1.022280072  0.818064261    1.30930733     1 #> 39      G39 -0.530723976  0.112723589    0.54256294     0 #> 40      G40  0.592816686  0.109909921    0.60291941     0 #> 41      G41 -0.192537359 -0.627072710    0.65596556     0 #> 42      G42  0.891032123 -0.996361906    1.33666574     1 #> 43      G43 -0.464624619  0.336867829    0.57389544     0 #> 44      G44 -0.672035171 -0.153673238    0.68938141     0 #> 45      G45  1.202473257 -1.049066580    1.59577023     1 #> 46      G46  0.581010487 -0.356631721    0.68173262     0 #> 47      G47 -0.520019185  0.446985167    0.68572275     0 #> 48      G48  0.866064198 -0.483528062    0.99190049     0 #> 49      G49 -0.050048388  0.465931046    0.46861133     0 #> 50      G50 -0.968073094  0.220007128    0.99275810     0 #> 51      G51  0.915380367 -0.033433182    0.91599072     0 #> 52      G52  1.140825106 -0.053478836    1.14207789     1 #> 53      G53  0.567489561 -1.306684815    1.42459454     1 #> 54      G54  1.094013325  1.008566742    1.48797582     1 #> 55      G55  1.193459273 -0.058610112    1.19489756     1 #> 56      G56  0.059219499  0.130410667    0.14322671     0 #> 57      G57 -2.636899472  0.184533512    2.64334853     1 #> 58      G58 -0.822716396 -0.172518868    0.84060991     0 #> 59      G59 -1.506355281 -0.552979622    1.60464722     1 #> 60      G60  0.089492570 -1.011045935    1.01499892     1 #> 61      G61  1.103801649  0.685186137    1.29917594     1 #> 62      G62  0.266059470  0.641570828    0.69455077     0 #> 63      G63  0.027137577  0.484081506    0.48484157     0 #> 64      G64  0.053860177  0.750449438    0.75237974     0 #>  #> $plots #> $plots$loadings  #>  #> $plots$biplot  #>  #> $plots$biplot_scaled  #>  #> $plots$loadings_c  #>  #>  # }"},{"path":"https://apariciojohan.github.io/agriutilities/reference/ggCor.html","id":null,"dir":"Reference","previous_headings":"","what":"Triangular correlation plot — ggCor","title":"Triangular correlation plot — ggCor","text":"Return ggplot object plot triangular correlation figure 2 variables.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/ggCor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Triangular correlation plot — ggCor","text":"","code":"ggCor(   data,   colours = c(\"#db4437\", \"white\", \"#FF9D00\"),   blackLabs = c(-0.7, 0.7),   showSignif = TRUE,   pBreaks = c(0, 0.001, 0.01, 0.05, Inf),   pLabels = c(\"***\", \"**\", \"*\", \"ns\"),   showDiagonal = FALSE,   Diag = NULL,   returnTable = FALSE,   returnN = FALSE,   adjusted = TRUE,   label_size = 3 )"},{"path":"https://apariciojohan.github.io/agriutilities/reference/ggCor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Triangular correlation plot — ggCor","text":"data data.frame numerical columns variable compared. colours vector size three colors used values -1, 0 1. blackLabs numeric vector size two, min max correlation coefficient showSignif Logical scalar. Display significance values ? pBreaks Passed function 'cut'. Either numeric vector two unique cut points single number (greater equal 2) giving number intervals x cut. pLabels Passed function 'cut'. labels levels resulting category. default, labels constructed using \"(,b]\" interval notation. pLabels = FALSE, simple integer codes returned instead factor. showDiagonal Logical scalar. Display main diagonal values ? Diag named vector labels display main diagonal. names used place value corresponding coordinates diagonal. Hence, names must colnames data. returnTable Return table display instead ggplot object returnN Return plot shared information adjusted Use adjusted p values multiple testing instead raw coeffs. TRUE default. label_size Numeric value indicating label size. 3 default.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/ggCor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Triangular correlation plot — ggCor","text":"ggplot object containing triangular correlation figure numeric variables data. returnTable TRUE, table used produce figure returned instead.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/ggCor.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Triangular correlation plot — ggCor","text":"Daniel Ariza, Johan Aparicio.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/ggCor.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Triangular correlation plot — ggCor","text":"","code":"# \\donttest{ data(iris) ggCor(  data = iris,  colours = c(\"#db4437\",\"white\",\"#4285f4\"),  label_size = 6 ) #> Dropping non-numeric columns in the dataset: #> Species  # }"},{"path":"https://apariciojohan.github.io/agriutilities/reference/gg_cor.html","id":null,"dir":"Reference","previous_headings":"","what":"Triangular Correlation Plot — gg_cor","title":"Triangular Correlation Plot — gg_cor","text":"Return ggplot object plot triangular correlation figure 2 variables.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/gg_cor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Triangular Correlation Plot — gg_cor","text":"","code":"gg_cor(   data,   colours = c(\"#db4437\", \"white\", \"#FF9D00\"),   blackLabs = c(-0.7, 0.7),   showSignif = TRUE,   pBreaks = c(0, 0.001, 0.01, 0.05, Inf),   pLabels = c(\"***\", \"**\", \"*\", \"ns\"),   showDiagonal = FALSE,   Diag = NULL,   returnTable = FALSE,   returnN = FALSE,   adjusted = TRUE,   label_size = 3 )"},{"path":"https://apariciojohan.github.io/agriutilities/reference/gg_cor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Triangular Correlation Plot — gg_cor","text":"data data.frame numerical columns variable compared. colours vector size three colors used values -1, 0 1. blackLabs numeric vector size two, min max correlation coefficient. showSignif Logical scalar. Display significance values ? pBreaks Passed function 'cut'. Either numeric vector two unique cut points single number (greater equal 2) giving number intervals x cut. pLabels Passed function 'cut'. labels levels resulting category. default, labels constructed using \"(,b]\" interval notation. pLabels = FALSE, simple integer codes returned instead factor. showDiagonal Logical scalar. Display main diagonal values ? Diag named vector labels display main diagonal. names used place value corresponding coordinates diagonal. Hence, names must colnames data. returnTable Return table display instead ggplot object. returnN Return plot shared information. adjusted Use adjusted p values multiple testing instead raw coeffs. TRUE default. label_size Numeric value indicating label size. 3 default.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/gg_cor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Triangular Correlation Plot — gg_cor","text":"ggplot object containing triangular correlation figure numeric variables data. returnTable TRUE, table used produce figure returned instead.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/gg_cor.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Triangular Correlation Plot — gg_cor","text":"Daniel Ariza, Johan Aparicio.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/gg_cor.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Triangular Correlation Plot — gg_cor","text":"","code":"library(agriutilities) data(iris) gg_cor(   data = iris,   colours = c(\"#db4437\", \"white\", \"#4285f4\"),   label_size = 6 ) #> Dropping non-numeric columns in the dataset: #> Species"},{"path":"https://apariciojohan.github.io/agriutilities/reference/heritability_fa.html","id":null,"dir":"Reference","previous_headings":"","what":"Heritability for Factor Analytic Models in ASReml-R — heritability_fa","title":"Heritability for Factor Analytic Models in ASReml-R — heritability_fa","text":"Heritability Factor Analytic Models ASReml-R","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/heritability_fa.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Heritability for Factor Analytic Models in ASReml-R — heritability_fa","text":"","code":"heritability_fa(   model_fa = NULL,   genotype = \"line\",   env = \"loc\",   vc_model = c(\"fa2\"),   diag = FALSE )"},{"path":"https://apariciojohan.github.io/agriutilities/reference/heritability_fa.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Heritability for Factor Analytic Models in ASReml-R — heritability_fa","text":"model_fa Factor Analytic ASReml model genotype character string indicating column data contains genotypes. env character string indicating column data contains environments trials. vc_model character string indicating variance-covariance structure. Can \"fa1\", \"fa2\", \"fa3\", \"fa4\" \"us\". diag TRUE FALSE depending user want take elements diagonal variance-covariance matrix elements diagonal estimate heritability. FALSE default.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/heritability_fa.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Heritability for Factor Analytic Models in ASReml-R — heritability_fa","text":"object list : h2_cullis numerical value Cullis heritability estimate. h2_se numerical value Cullis heritability estimate based  standard error.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/heritability_fa.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Heritability for Factor Analytic Models in ASReml-R — heritability_fa","text":"","code":"# \\donttest{ library(agridat) library(agriutilities) data(besag.met) dat <- besag.met results <- check_design_met(   data = dat,   genotype = \"gen\",   trial = \"county\",   traits = c(\"yield\"),   rep = \"rep\",   block = \"block\",   col = \"col\",   row = \"row\" ) out <- single_trial_analysis(results, progress = FALSE) met_results <- met_analysis(out, progress = FALSE) model <- met_results$met_models$yield # heritability_fa( #    model_fa = model, #    genotype = \"genotype\", #    env = \"trial\", #    vc_model = \"us\" #  ) # }"},{"path":"https://apariciojohan.github.io/agriutilities/reference/h_cullis.html","id":null,"dir":"Reference","previous_headings":"","what":"Cullis heritability for lme4 models — h_cullis","title":"Cullis heritability for lme4 models — h_cullis","text":"Cullis heritability lme4 models","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/h_cullis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cullis heritability for lme4 models — h_cullis","text":"","code":"h_cullis(model, genotype, re_MME = FALSE)"},{"path":"https://apariciojohan.github.io/agriutilities/reference/h_cullis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cullis heritability for lme4 models — h_cullis","text":"model Object class lmer. genotype character string indicating column data contains genotypes. re_MME logical value ask want reconstruct mixed models equations estimate Cullis heritability. (FALSE default)","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/h_cullis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cullis heritability for lme4 models — h_cullis","text":"numerical value Cullis heritability estimate. re_MME TRUE, list matrices mixed models equations returned.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/h_cullis.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Cullis heritability for lme4 models — h_cullis","text":"Paul Schmidt, Johan Aparicio.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/h_cullis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Cullis heritability for lme4 models — h_cullis","text":"","code":"library(lme4) #> Warning: package 'lme4' was built under R version 4.1.3 #> Loading required package: Matrix #> Warning: package 'Matrix' was built under R version 4.1.3 library(agridat) library(agriutilities) dat <- john.alpha g.ran <- lmer(   formula = yield ~ rep + (1 | gen) + (1 | rep:block),   data = dat ) h_cullis(model = g.ran, genotype = \"gen\") #> [1] 0.7979968"},{"path":"https://apariciojohan.github.io/agriutilities/reference/met_analysis.html","id":null,"dir":"Reference","previous_headings":"","what":"Multi-Environmental Trial Analysis — met_analysis","title":"Multi-Environmental Trial Analysis — met_analysis","text":"results single_trial_analysis() function used met_analysis() fit multi-environmental trial models. Returns object class metAgri, list trial effects, BLUPs, heritability, variance components, stability models fitted.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/met_analysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Multi-Environmental Trial Analysis — met_analysis","text":"","code":"met_analysis(   sma_output = NULL,   h2_filter = 0.2,   workspace = \"1gb\",   vcov = NULL,   filter_traits = NULL,   remove_trials = NULL,   progress = TRUE )"},{"path":"https://apariciojohan.github.io/agriutilities/reference/met_analysis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Multi-Environmental Trial Analysis — met_analysis","text":"sma_output Object class smaAgri resulting executing single_trial_analysis() function. h2_filter Numeric value filter trials poor heritability. 0.2 default. workspace Sets workspace core REML routines form number optionally followed directly valid measurement unit. \"128mb\" default. vcov character string specifying Variance-Covariance structure fitted. Can \"fa2\", \"fa1\", \"us\", \"corh\" \"corv\". NULL function try fit \"us\" Variance-Covariance fails, try \"fa2\" \"fa1\". filter_traits character vector traits filter. NULL default. remove_trials character vector trials remove. NULL default. progress progress modeling printed. TRUE, every trait line output indicating model fitted.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/met_analysis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Multi-Environmental Trial Analysis — met_analysis","text":"object class metAgri, list : trial_effects data.frame containing Trial BLUEs. overall_BLUPs data.frame containing Genotypic BLUPs across trials, trait. BLUPs_GxE data.frame containing Genotypic BLUPs trial/trait. VCOV list trait contanining variance-covariance fitted. stability data.frame containing several Stability coefficients resulting executing function stability(). heritability data.frame containing overall heritabilities trait. met_models list trait containing fitted models.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/met_analysis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Multi-Environmental Trial Analysis — met_analysis","text":"","code":"# \\donttest{ library(agridat) library(agriutilities) data(besag.met) dat <- besag.met results <- check_design_met(   data = dat,   genotype = \"gen\",   trial = \"county\",   traits = c(\"yield\"),   rep = \"rep\",   block = \"block\",   col = \"col\",   row = \"row\" ) out <- single_trial_analysis(results, progress = FALSE) met_results <- met_analysis(out, progress = FALSE) print(met_results) #> --------------------------------------------------------------------- #> Trial Effects (BLUEs): #> --------------------------------------------------------------------- #>   trait trial predicted.value std.error    status #> 1 yield    C1       149.74946  1.358117 Estimable #> 2 yield    C2        65.99561  1.141995 Estimable #> 3 yield    C3        90.60825  1.449096 Estimable #> 4 yield    C4       148.12392  1.202934 Estimable #> 5 yield    C5       121.77612  1.429239 Estimable #> 6 yield    C6        88.31194  1.532688 Estimable #>  #> --------------------------------------------------------------------- #> Heritability: #> --------------------------------------------------------------------- #>   trait        h2 #> 1 yield 0.8239191 #>  #> --------------------------------------------------------------------- #> First Overall Predicted Values and Standard Errors (BLUPs): #> --------------------------------------------------------------------- #>   trait genotype predicted.value std.error    status #> 1 yield      G01        110.4297  2.528111 Estimable #> 2 yield      G02        110.8617  2.537200 Estimable #> 3 yield      G03        102.6812  2.541066 Estimable #> 4 yield      G04        115.4946  2.533730 Estimable #> 5 yield      G05        120.6600  2.548344 Estimable #> 6 yield      G06        108.8297  2.555281 Estimable #>  #> --------------------------------------------------------------------- #> Variance-Covariance Matrix: #> --------------------------------------------------------------------- #>  #> Correlation Matrix ('us'): yield #>      C1   C2   C3   C4   C5   C6 #> C1 1.00 0.57 0.58 0.65 0.95 0.43 #> C2 0.57 1.00 0.55 0.70 0.52 0.76 #> C3 0.58 0.55 1.00 0.95 0.72 0.27 #> C4 0.65 0.70 0.95 1.00 0.75 0.47 #> C5 0.95 0.52 0.72 0.75 1.00 0.33 #> C6 0.43 0.76 0.27 0.47 0.33 1.00 #>  #> Covariance Matrix ('us'): yield #>       C1    C2    C3    C4     C5    C6 #> C1 80.57 27.36 46.81 31.67  85.61 31.17 #> C2 27.36 28.90 26.44 20.41  27.99 33.51 #> C3 46.81 26.44 79.66 45.84  64.54 19.81 #> C4 31.67 20.41 45.84 29.28  40.79 20.76 #> C5 85.61 27.99 64.54 40.79 100.60 27.13 #> C6 31.17 33.51 19.81 20.76  27.13 66.66 #>  #> --------------------------------------------------------------------- #> First Stability Coefficients: #> --------------------------------------------------------------------- #>   trait genotype superiority   static    wricke predicted.value #> 1 yield      G57    22.67503 32.45871 13.962970        92.45997 #> 2 yield      G29    17.27533 34.41794  4.343501        99.38429 #> 3 yield      G34    17.26249 33.29276  8.514332        99.74688 #> 4 yield      G59    16.94882 34.39425  4.798863        99.87221 #> 5 yield      G31    16.23001 31.89042 11.722935       101.66382 #> 6 yield      G10    15.75253 32.02994 11.499867       102.39802 #>  covcor_heat(matrix = met_results$VCOV$yield$CORR)  # }"},{"path":"https://apariciojohan.github.io/agriutilities/reference/parameters_gg.html","id":null,"dir":"Reference","previous_headings":"","what":"Genetic Gain Parameters — parameters_gg","title":"Genetic Gain Parameters — parameters_gg","text":"Genetic Gain Parameters","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/parameters_gg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Genetic Gain Parameters — parameters_gg","text":"","code":"parameters_gg(model, trait = \"trait\")"},{"path":"https://apariciojohan.github.io/agriutilities/reference/parameters_gg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Genetic Gain Parameters — parameters_gg","text":"model Linear regression model (lm object) trait character string indicating column data contains trials.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/parameters_gg.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Genetic Gain Parameters — parameters_gg","text":"data.frame parameters linear regression (Slope, se_Slope, Intercept, r2, Pr(>F)) percentage Genetic Gain.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/parameters_gg.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Genetic Gain Parameters — parameters_gg","text":"","code":"library(ggplot2) #> Warning: package 'ggplot2' was built under R version 4.1.3 library(agridat) library(magrittr) #> Warning: package 'magrittr' was built under R version 4.1.3 library(agriutilities)  data(baker.barley.uniformity) dat <- baker.barley.uniformity head(dat) #>   row col year yield #> 1   1   1 1924  2960 #> 2   1   2 1924  3060 #> 3   1   3 1924  3280 #> 4   1   4 1924  2570 #> 5   1   5 1924  2000 #> 6   1   6 1924  1800  model <- lm(yield ~ year, dat)  dat %>%   na.omit() %>%   ggplot(     aes(x = year, y = yield)   ) +   geom_point()+   geom_smooth(method = \"lm\") +   theme_bw() #> `geom_smooth()` using formula = 'y ~ x'   parameters_gg(model = model, trait = \"yield\") #>            trait first_year last_year     Slope se_Slope Intercept        r2 #> Regression yield       1924      1935 -109.7417  7.97398  214307.5 0.2507339 #>                  Pr(>F) Genetic_Gain% #> Regression 2.215553e-37     -3.468011"},{"path":"https://apariciojohan.github.io/agriutilities/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://apariciojohan.github.io/agriutilities/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling `rhs(lhs)`.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/plot.checkAgri.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot an object of class checkAgri — plot.checkAgri","title":"Plot an object of class checkAgri — plot.checkAgri","text":"Create several plots object class checkAgri","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/plot.checkAgri.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot an object of class checkAgri — plot.checkAgri","text":"","code":"# S3 method for checkAgri plot(   x,   type = c(\"connectivity\", \"missing\", \"boxplot\"),   axis_size = 15,   text_size = 5,   ... )"},{"path":"https://apariciojohan.github.io/agriutilities/reference/plot.checkAgri.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot an object of class checkAgri — plot.checkAgri","text":"x object inheriting class checkAgri resulting executing function check_design_met() type character string specifiying type plot. \"connectivity\", \"missing\" \"boxplot\". axis_size Numeric input define axis size. text_size Numeric input define text size. ... graphical parameters. future improvements.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/plot.checkAgri.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Plot an object of class checkAgri — plot.checkAgri","text":"Johan Aparicio [aut]","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/plot.checkAgri.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot an object of class checkAgri — plot.checkAgri","text":"","code":"library(agridat) library(agriutilities) data(besag.met) dat <- besag.met results <- check_design_met(   data = dat,   genotype = \"gen\",   trial = \"county\",   traits = c(\"yield\"),   rep = \"rep\",   block = \"block\",   col = \"col\",   row = \"row\" ) plot(results, type = \"missing\")  plot(results, type = \"boxplot\") #> Warning: Removed 36 rows containing non-finite values (`stat_boxplot()`)."},{"path":"https://apariciojohan.github.io/agriutilities/reference/print.checkAgri.html","id":null,"dir":"Reference","previous_headings":"","what":"Print an object of class checkAgri — print.checkAgri","title":"Print an object of class checkAgri — print.checkAgri","text":"Prints information check_design_met() function.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/print.checkAgri.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print an object of class checkAgri — print.checkAgri","text":"","code":"# S3 method for checkAgri print(x, ...)"},{"path":"https://apariciojohan.github.io/agriutilities/reference/print.checkAgri.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print an object of class checkAgri — print.checkAgri","text":"x object fitted function check_design_met(). ... Options used tibble package format output. See `tibble::print()` details.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/print.checkAgri.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Print an object of class checkAgri — print.checkAgri","text":"Johan Aparicio [aut]","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/print.checkAgri.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print an object of class checkAgri — print.checkAgri","text":"","code":"library(agridat) library(agriutilities) data(besag.met) dat <- besag.met results <- check_design_met(   data = dat,   genotype = \"gen\",   trial = \"county\",   traits = c(\"yield\"),   rep = \"rep\",   block = \"block\",   col = \"col\",   row = \"row\" ) print(results) #> --------------------------------------------------------------------- #> Summary Traits by Trial: #> --------------------------------------------------------------------- #> # A tibble: 6 x 9 #>   county traits  Mean Median    SD    CV     n n_miss miss_perc #>   <fct>  <chr>  <dbl>  <dbl> <dbl> <dbl> <int>  <int>     <dbl> #> 1 C1     yield  149.   151.   17.7 0.119   198      6    0.0303 #> 2 C2     yield   56.1   52.1  18.4 0.328   198      6    0.0303 #> 3 C3     yield   87.9   89.2  19.7 0.225   198      6    0.0303 #> 4 C4     yield  145.   143.   17.1 0.118   198      6    0.0303 #> 5 C5     yield  115.   116.   16.4 0.142   198      6    0.0303 #> 6 C6     yield   87.6   87.8  26.6 0.304   198      6    0.0303 #>  #> --------------------------------------------------------------------- #> Experimental Design Detected: #> --------------------------------------------------------------------- #>   county exp_design #> 1     C1    row_col #> 2     C2    row_col #> 3     C3    row_col #> 4     C4    row_col #> 5     C5    row_col #> 6     C6    row_col #>  #> --------------------------------------------------------------------- #> Summary Experimental Design: #> --------------------------------------------------------------------- #> # A tibble: 6 x 9 #>   county     n n_gen n_rep n_block n_col n_row num_of_reps num_of_gen #>   <fct>  <int> <int> <int>   <int> <int> <int> <fct>       <fct>      #> 1 C1       198    64     3       8    11    18 3_9         63_1       #> 2 C2       198    64     3       8    11    18 3_9         63_1       #> 3 C3       198    64     3       8    11    18 3_9         63_1       #> 4 C4       198    64     3       8    11    18 3_9         63_1       #> 5 C5       198    64     3       8    11    18 3_9         63_1       #> 6 C6       198    64     3       8    11    18 3_9         63_1       #>  #> --------------------------------------------------------------------- #> Connectivity Matrix: #> --------------------------------------------------------------------- #>    C1 C2 C3 C4 C5 C6 #> C1 64 64 64 64 64 64 #> C2 64 64 64 64 64 64 #> C3 64 64 64 64 64 64 #> C4 64 64 64 64 64 64 #> C5 64 64 64 64 64 64 #> C6 64 64 64 64 64 64 #>  #> --------------------------------------------------------------------- #> Filters Applied: #> --------------------------------------------------------------------- #> List of 1 #>  $ yield:List of 4 #>   ..$ missing_50%     : chr(0)  #>   ..$ no_variation    : chr(0)  #>   ..$ row_col_dup     : chr(0)  #>   ..$ trials_to_remove: chr(0)  #>"},{"path":"https://apariciojohan.github.io/agriutilities/reference/print.metAgri.html","id":null,"dir":"Reference","previous_headings":"","what":"Print an object of class metAgri — print.metAgri","title":"Print an object of class metAgri — print.metAgri","text":"Prints information met_analysis() function.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/print.metAgri.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print an object of class metAgri — print.metAgri","text":"","code":"# S3 method for metAgri print(x, ...)"},{"path":"https://apariciojohan.github.io/agriutilities/reference/print.metAgri.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print an object of class metAgri — print.metAgri","text":"x object fitted function met_analysis(). ... Options used tibble package format output. See `tibble::print()` details.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/print.metAgri.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Print an object of class metAgri — print.metAgri","text":"Johan Aparicio [aut]","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/print.metAgri.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print an object of class metAgri — print.metAgri","text":"","code":"# \\donttest{ library(agridat) library(agriutilities) data(besag.met) dat <- besag.met results <- check_design_met(   data = dat,   genotype = \"gen\",   trial = \"county\",   traits = c(\"yield\"),   rep = \"rep\",   block = \"block\",   col = \"col\",   row = \"row\" ) out <- single_trial_analysis(results, progress = FALSE) met_results <- met_analysis(out, progress = FALSE) print(met_results) #> --------------------------------------------------------------------- #> Trial Effects (BLUEs): #> --------------------------------------------------------------------- #>   trait trial predicted.value std.error    status #> 1 yield    C1       149.74946  1.358117 Estimable #> 2 yield    C2        65.99561  1.141995 Estimable #> 3 yield    C3        90.60825  1.449096 Estimable #> 4 yield    C4       148.12392  1.202934 Estimable #> 5 yield    C5       121.77612  1.429239 Estimable #> 6 yield    C6        88.31194  1.532688 Estimable #>  #> --------------------------------------------------------------------- #> Heritability: #> --------------------------------------------------------------------- #>   trait        h2 #> 1 yield 0.8239191 #>  #> --------------------------------------------------------------------- #> First Overall Predicted Values and Standard Errors (BLUPs): #> --------------------------------------------------------------------- #>   trait genotype predicted.value std.error    status #> 1 yield      G01        110.4297  2.528111 Estimable #> 2 yield      G02        110.8617  2.537200 Estimable #> 3 yield      G03        102.6812  2.541066 Estimable #> 4 yield      G04        115.4946  2.533730 Estimable #> 5 yield      G05        120.6600  2.548344 Estimable #> 6 yield      G06        108.8297  2.555281 Estimable #>  #> --------------------------------------------------------------------- #> Variance-Covariance Matrix: #> --------------------------------------------------------------------- #>  #> Correlation Matrix ('us'): yield #>      C1   C2   C3   C4   C5   C6 #> C1 1.00 0.57 0.58 0.65 0.95 0.43 #> C2 0.57 1.00 0.55 0.70 0.52 0.76 #> C3 0.58 0.55 1.00 0.95 0.72 0.27 #> C4 0.65 0.70 0.95 1.00 0.75 0.47 #> C5 0.95 0.52 0.72 0.75 1.00 0.33 #> C6 0.43 0.76 0.27 0.47 0.33 1.00 #>  #> Covariance Matrix ('us'): yield #>       C1    C2    C3    C4     C5    C6 #> C1 80.57 27.36 46.81 31.67  85.61 31.17 #> C2 27.36 28.90 26.44 20.41  27.99 33.51 #> C3 46.81 26.44 79.66 45.84  64.54 19.81 #> C4 31.67 20.41 45.84 29.28  40.79 20.76 #> C5 85.61 27.99 64.54 40.79 100.60 27.13 #> C6 31.17 33.51 19.81 20.76  27.13 66.66 #>  #> --------------------------------------------------------------------- #> First Stability Coefficients: #> --------------------------------------------------------------------- #>   trait genotype superiority   static    wricke predicted.value #> 1 yield      G57    22.67503 32.45871 13.962970        92.45997 #> 2 yield      G29    17.27533 34.41794  4.343501        99.38429 #> 3 yield      G34    17.26249 33.29276  8.514332        99.74688 #> 4 yield      G59    16.94882 34.39425  4.798863        99.87221 #> 5 yield      G31    16.23001 31.89042 11.722935       101.66382 #> 6 yield      G10    15.75253 32.02994 11.499867       102.39802 #>  # }"},{"path":"https://apariciojohan.github.io/agriutilities/reference/print.smaAgri.html","id":null,"dir":"Reference","previous_headings":"","what":"Print an object of class smaAgri — print.smaAgri","title":"Print an object of class smaAgri — print.smaAgri","text":"Prints information single_trial_analysis function.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/print.smaAgri.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print an object of class smaAgri — print.smaAgri","text":"","code":"# S3 method for smaAgri print(x, ...)"},{"path":"https://apariciojohan.github.io/agriutilities/reference/print.smaAgri.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print an object of class smaAgri — print.smaAgri","text":"x object fitted function single_trial_analysis(). ... Options used tibble package format output. See `tibble::print()` details.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/print.smaAgri.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Print an object of class smaAgri — print.smaAgri","text":"Johan Aparicio [aut]","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/print.smaAgri.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print an object of class smaAgri — print.smaAgri","text":"","code":"library(agridat) library(agriutilities) data(besag.met) dat <- besag.met results <- check_design_met(   data = dat,   genotype = \"gen\",   trial = \"county\",   traits = c(\"yield\"),   rep = \"rep\",   block = \"block\",   col = \"col\",   row = \"row\" ) out <- single_trial_analysis(results, progress = FALSE) print(out) #> --------------------------------------------------------------------- #> Summary Fitted Models: #> --------------------------------------------------------------------- #>    trait trial heritability        CV    VarGen    VarErr  design #> 1: yield    C1         0.73  6.022489  87.39848  82.86095 row_col #> 2: yield    C2         0.37 17.104998  25.80684 108.68546 row_col #> 3: yield    C3         0.64 12.357202  83.57907 118.55567 row_col #> 4: yield    C4         0.41  8.179408  35.75568 136.21218 row_col #> 5: yield    C5         0.80  7.037586 103.79822  66.97523 row_col #> 6: yield    C6         0.49 16.632367  71.92232 207.53073 row_col #>  #> --------------------------------------------------------------------- #> Outliers Removed: #> --------------------------------------------------------------------- #>    trait trial genotype id outlier #> 1: yield    C1      G60 50    TRUE #>  #> --------------------------------------------------------------------- #> First Predicted Values and Standard Errors (BLUEs/BLUPs): #> --------------------------------------------------------------------- #>    trait genotype trial    BLUEs  seBLUEs    BLUPs  seBLUPs         wt #> 1: yield      G01    C1 141.4161 6.078858 143.5308 5.249771 0.02706176 #> 2: yield      G02    C1 157.8110 5.979708 155.8037 5.194547 0.02796663 #> 3: yield      G03    C1 127.3836 6.091534 133.0256 5.269999 0.02694925 #> 4: yield      G04    C1 154.8445 6.093866 153.8364 5.270427 0.02692863 #> 5: yield      G05    C1 163.8950 6.132141 161.1831 5.271809 0.02659352 #> 6: yield      G06    C1 128.5168 6.087902 133.6857 5.247130 0.02698141 #>"},{"path":"https://apariciojohan.github.io/agriutilities/reference/single_trial_analysis.html","id":null,"dir":"Reference","previous_headings":"","what":"Single Trial Analysis — single_trial_analysis","title":"Single Trial Analysis — single_trial_analysis","text":"results check_design_met() function used single_trial_analysis() fit single trial models. function can fit, Completely Randomized Designs (CRD), Randomized Complete Block Designs (RCBD), Resolvable Incomplete Block Designs (res-IBD), Non-Resolvable Row-Column Designs (Row-Col) Resolvable Row-Column Designs (res-Row-Col). Returns object class smaAgri, list trial summary, BLUEs, BLUPs, heritability, variance components, potential extreme observations, residuals, models fitted data used. function generate required output used two-stage analysis.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/single_trial_analysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single Trial Analysis — single_trial_analysis","text":"","code":"single_trial_analysis(   results = NULL,   progress = TRUE,   engine = \"asreml\",   remove_outliers = TRUE )"},{"path":"https://apariciojohan.github.io/agriutilities/reference/single_trial_analysis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single Trial Analysis — single_trial_analysis","text":"results Object class checkAgri resulting executing check_design_met() function. progress progress modeling printed. TRUE, every trial line output indicating traits fitted particular trial. engine character string specifying name mixed modeling engine use, either lme4 asreml. spatial designs, SpATS always used, designs asreml default. remove_outliers outliers removed? TRUE default.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/single_trial_analysis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Single Trial Analysis — single_trial_analysis","text":"object class smaAgri, list : fitted_models list containing fitted models. (models, one Genotype Random one Genotype Fixed) resum_fitted_model data.frame containing summary fitted models. outliers data.frame containing extreme observations. remove_outliers TRUE, data.frame contain observations removed. blues_blups data.frame containing BLUPs/BLUEs genotypes trial. std_residuals data.frame containing standardized residuals model genotype random component. data data.frame containing data used. remove_outliers TRUE, data missing values outliers detected.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/single_trial_analysis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Single Trial Analysis — single_trial_analysis","text":"","code":"library(agridat) library(agriutilities) data(besag.met) dat <- besag.met results <- check_design_met(   data = dat,   genotype = \"gen\",   trial = \"county\",   traits = c(\"yield\"),   rep = \"rep\",   block = \"block\",   col = \"col\",   row = \"row\" ) out <- single_trial_analysis(results, progress = FALSE) print(out) #> --------------------------------------------------------------------- #> Summary Fitted Models: #> --------------------------------------------------------------------- #>    trait trial heritability        CV    VarGen    VarErr  design #> 1: yield    C1         0.73  6.022489  87.39848  82.86095 row_col #> 2: yield    C2         0.37 17.104998  25.80684 108.68546 row_col #> 3: yield    C3         0.64 12.357202  83.57907 118.55567 row_col #> 4: yield    C4         0.41  8.179408  35.75568 136.21218 row_col #> 5: yield    C5         0.80  7.037586 103.79822  66.97523 row_col #> 6: yield    C6         0.49 16.632367  71.92232 207.53073 row_col #>  #> --------------------------------------------------------------------- #> Outliers Removed: #> --------------------------------------------------------------------- #>    trait trial genotype id outlier #> 1: yield    C1      G60 50    TRUE #>  #> --------------------------------------------------------------------- #> First Predicted Values and Standard Errors (BLUEs/BLUPs): #> --------------------------------------------------------------------- #>    trait genotype trial    BLUEs  seBLUEs    BLUPs  seBLUPs         wt #> 1: yield      G01    C1 141.4161 6.078858 143.5308 5.249771 0.02706176 #> 2: yield      G02    C1 157.8110 5.979708 155.8037 5.194547 0.02796663 #> 3: yield      G03    C1 127.3836 6.091534 133.0256 5.269999 0.02694925 #> 4: yield      G04    C1 154.8445 6.093866 153.8364 5.270427 0.02692863 #> 5: yield      G05    C1 163.8950 6.132141 161.1831 5.271809 0.02659352 #> 6: yield      G06    C1 128.5168 6.087902 133.6857 5.247130 0.02698141 #>"},{"path":"https://apariciojohan.github.io/agriutilities/reference/stability.html","id":null,"dir":"Reference","previous_headings":"","what":"Stability Coefficients — stability","title":"Stability Coefficients — stability","text":"Stability Coefficients","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/stability.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Stability Coefficients — stability","text":"","code":"stability(   predictions = NULL,   genotype = NULL,   trial = NULL,   response = NULL,   best = \"max\" )"},{"path":"https://apariciojohan.github.io/agriutilities/reference/stability.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Stability Coefficients — stability","text":"predictions data.frame one value per GxE combination. genotype character string indicating column predictions contains genotypes. trial character string indicating column predictions contains trials. response character string specifying response variable. best character string specifying define best genotype numeric value (\"min\", \"max\"). \"max\" default.","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/stability.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Stability Coefficients — stability","text":"data.frame several stability measures. \"superiority\" (cultivar-superiority measure), \"static\" (Shukla's stability variance) \"wricke\" (Wricke's ecovalence).","code":""},{"path":"https://apariciojohan.github.io/agriutilities/reference/stability.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Stability Coefficients — stability","text":"","code":"# \\donttest{ library(agridat) library(agriutilities)  data(besag.met) dat <- besag.met results <- check_design_met(   data = dat,   genotype = \"gen\",   trial = \"county\",   traits = c(\"yield\"),   rep = \"rep\",   block = \"block\",   col = \"col\",   row = \"row\" ) out <- single_trial_analysis(results, progress = FALSE) met_results <- met_analysis(out, progress = FALSE)  head(   stability(     predictions = met_results$BLUPs_GxE,     genotype = \"genotype\",     trial = \"trial\",     response = \"predicted.value\"   ) ) #>   genotype superiority   static    wricke predicted.value #> 1      G57    22.67503 32.45871 13.962970        92.45997 #> 2      G29    17.27533 34.41794  4.343501        99.38429 #> 3      G34    17.26249 33.29276  8.514332        99.74688 #> 4      G59    16.94882 34.39425  4.798863        99.87221 #> 5      G31    16.23001 31.89042 11.722935       101.66382 #> 6      G10    15.75253 32.02994 11.499867       102.39802 # }"}]
