<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Factor analytic variance models. — fa.asreml • agriutilities</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Factor analytic variance models. — fa.asreml"><meta property="og:description" content="Summarises an asreml model in which factor analytic (FA) variance structures have been fitted. The function
aids in interpreting FA models fitted to genotype by environment effects in the analysis
of plant breeding multi-environment trial (MET) data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">agriutilities</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-code"></span>
     
    Reference
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/AparicioJohan/agriutilities" class="external-link">
    <span class="fa fa-github"></span>
     
    Github
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Factor analytic variance models.</h1>
    <small class="dont-index">Source: <a href="https://github.com/AparicioJohan/agriutilities/blob/HEAD/R/fa.R" class="external-link"><code>R/fa.R</code></a></small>
    <div class="hidden name"><code>fa.asreml.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Summarises an asreml model in which factor analytic (FA) variance structures have been fitted. The function
aids in interpreting FA models fitted to genotype by environment effects in the analysis
of plant breeding multi-environment trial (MET) data.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fa.asreml</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  uniplot <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  uniplot.tol <span class="op">=</span> <span class="fl">0.85</span>,</span>
<span>  uniplot.cex <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  trunc.char <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  blups <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  regplot <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  addedplot <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  g.list <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  heatmap <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  heatmap.ord <span class="op">=</span> <span class="st">"asis"</span>,</span>
<span>  agnes.method <span class="op">=</span> <span class="st">"average"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>An asreml object.</p></dd>


<dt>uniplot</dt>
<dd><p>if TRUE (the default), pairwise plots of FA loadings are produced for k &gt; 1.</p></dd>


<dt>uniplot.tol</dt>
<dd><p>A numeric value between 0 and 1 that affects the display of pairs of loadings in the uniplots. Those pairs with a (scaled) euclidean distance greater than uniplot.tol are drawn with solid blue lines, otherwise they appear as red dashed lines.</p></dd>


<dt>uniplot.cex</dt>
<dd><p>Character expansion (relative) size for plotting (the default is 0.5).</p></dd>


<dt>trunc.char</dt>
<dd><p>A numeric vector of length 2 specifying the truncation of loading labels for use in plotting. The default (c(1,6)) is to use the first 6 characters of the environment factor levels, otherwise if NULL the complete level names are used.</p></dd>


<dt>blups</dt>
<dd><p>If TRUE (the default), summaries of estimates from the asreml object are produced. These include BLUPs of genotype by environment effects and genotype scores, and REML estimates of FA variance parameters.</p></dd>


<dt>regplot</dt>
<dd><p>If TRUE (the default), regression plots of genotype by environment effects against FA loadings are produced.</p></dd>


<dt>addedplot</dt>
<dd><p>If TRUE (the default), added variable plots of genotype by environment effects against FA loadings are produced.</p></dd>


<dt>g.list</dt>
<dd><p>A character vector comprising the subset of genotype levels to be used in the regression and added variable plots. The default (NULL) is to use the complete set of genotype levels.</p></dd>


<dt>heatmap</dt>
<dd><p>If TRUE (the default), a heatmap of the estimated FA correlation matrix is produced.</p></dd>


<dt>heatmap.ord</dt>
<dd><p>A character string ("asis", "cluster") or vector of environment levels in the order desired for plotting the heatmap. The default is "asis", where the rows and columns of the correlation matrix are maintained in environment level order. The "cluster" option invokes the agnes clustering algorithm on the FA correlation matrix then orders the rows and columns accordingly.</p></dd>


<dt>agnes.method</dt>
<dd><p>Clustering strategy; the default is "average".</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>list</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The following function is taken from the ASExtras4 package. Please refer to this package and associated publications if you are interested in going deeper on this technique. You may be interested in reading and citing this publication if using this methodology</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Cullis BR, Smith AB, Beek C, Cowling WA (2010). “Analysis of Yield and Oil from a Series of Canola Breeding Trials. Part II: Exploring VxE using Factor Analysis.” Genome, 53, 1002-1016. Smith AB, Cullis BR, Thompson R (2001). “Analyzing Variety by Environment Data Using Multiplicative Mixed Models and Adjustments for Spatial Field Trend.” Biometrics, 57, 1138-1147.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># library(tidyverse)</span></span></span>
<span class="r-in"><span><span class="co"># library(asreml)</span></span></span>
<span class="r-in"><span><span class="co"># library(agridat)</span></span></span>
<span class="r-in"><span><span class="co"># data(besag.met)</span></span></span>
<span class="r-in"><span><span class="co"># dat &lt;- besag.met</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># dat &lt;- dat %&gt;% arrange(county)</span></span></span>
<span class="r-in"><span><span class="co"># model &lt;- asreml(fixed = yield ~ 1 + county,</span></span></span>
<span class="r-in"><span><span class="co">#                 random = ~ fa(county, 2):gen + county:rep + diag(county):rep:block,</span></span></span>
<span class="r-in"><span><span class="co">#                 residual = ~ dsum(~ units | county),</span></span></span>
<span class="r-in"><span><span class="co">#                 data = dat,</span></span></span>
<span class="r-in"><span><span class="co">#                 na.action = list(x="include",y="include"))</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># ASM &lt;- fa.asreml(model, trunc.char = NULL)</span></span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Johan Aparicio.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

