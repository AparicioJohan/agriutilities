<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The results of the check_design_met() function are used in
single_trial_analysis() to fit single trial models. This function can
fit, Completely Randomized Designs (CRD), Randomized Complete Block Designs
(RCBD), Resolvable Incomplete Block Designs (res-IBD), Non-Resolvable
Row-Column Designs (Row-Col) and Resolvable Row-Column Designs (res-Row-Col).
Returns an object of class smaAgri, with a list of trial summary,
BLUEs, BLUPs, heritability, variance components, potential extreme
observations, residuals,
the models fitted and the data used.
This function will generate the required output to be used in the two-stage
analysis."><title>Single Trial Analysis — single_trial_analysis • agriutilities</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Single Trial Analysis — single_trial_analysis"><meta property="og:description" content="The results of the check_design_met() function are used in
single_trial_analysis() to fit single trial models. This function can
fit, Completely Randomized Designs (CRD), Randomized Complete Block Designs
(RCBD), Resolvable Incomplete Block Designs (res-IBD), Non-Resolvable
Row-Column Designs (Row-Col) and Resolvable Row-Column Designs (res-Row-Col).
Returns an object of class smaAgri, with a list of trial summary,
BLUEs, BLUPs, heritability, variance components, potential extreme
observations, residuals,
the models fitted and the data used.
This function will generate the required output to be used in the two-stage
analysis."><meta property="og:image" content="https://apariciojohan.github.io/agriutilities/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-secondary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">agriutilities</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
    Home
  </a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa-code"></span>
     
    Reference
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--articles">
    <span class="fa fa-book"></span>
     
    Articles
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--articles">
    <a class="dropdown-item" href="../articles/how-to-start.html">How to Start</a>
    <a class="dropdown-item" href="../articles/repeated_measurements.html">Repeated Measurements</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">
    <span class="fa fa-newspaper"></span>
     
    News
  </a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/AparicioJohan/agriutilities">
    <span class="fa fa-github"></span>
     
    Github
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Single Trial Analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/AparicioJohan/agriutilities/blob/HEAD/R/fitSingle.R" class="external-link"><code>R/fitSingle.R</code></a></small>
      <div class="d-none name"><code>single_trial_analysis.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The results of the <code><a href="check_design_met.html">check_design_met()</a></code> function are used in
<code>single_trial_analysis()</code> to fit single trial models. This function can
fit, Completely Randomized Designs (CRD), Randomized Complete Block Designs
(RCBD), Resolvable Incomplete Block Designs (res-IBD), Non-Resolvable
Row-Column Designs (Row-Col) and Resolvable Row-Column Designs (res-Row-Col).</p>
<p>Returns an object of class <code>smaAgri</code>, with a list of trial summary,
BLUEs, BLUPs, heritability, variance components, potential extreme
observations, residuals,
the models fitted and the data used.
This function will generate the required output to be used in the two-stage
analysis.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">single_trial_analysis</span><span class="op">(</span></span>
<span>  results <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  engine <span class="op">=</span> <span class="st">"asreml"</span>,</span>
<span>  remove_outliers <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>results</dt>
<dd><p>Object of class <code>checkAgri</code> resulting of executing
<code><a href="check_design_met.html">check_design_met()</a></code> function.</p></dd>


<dt>progress</dt>
<dd><p>Should the progress of the modeling be printed.
If <code>TRUE</code>, for every trial a line is output indicating the traits fitted
for the particular trial.</p></dd>


<dt>engine</dt>
<dd><p>A character string specifying the name of the mixed modeling
engine to use, either <code>lme4</code> or <code>asreml</code>. For spatial designs,
<code>SpATS</code> is always used, for other designs <code>asreml</code> as a default.</p></dd>


<dt>remove_outliers</dt>
<dd><p>Should outliers be removed? <code>TRUE</code> by default.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code>smaAgri</code>, with a list of:</p>
<dl><dt>fitted_models</dt>
<dd><p>A list containing the fitted models. (Both models, the
one with Genotype as Random and the one with Genotype as Fixed)</p></dd>

<dt>resum_fitted_model</dt>
<dd><p>A data.frame containing a summary of the fitted
models.</p></dd>

<dt>outliers</dt>
<dd><p>A data.frame containing extreme observations. If
<code>remove_outliers</code> is <code>TRUE</code>, this data.frame will contain the
observations removed.</p></dd>

<dt>blues_blups</dt>
<dd><p>A data.frame containing BLUPs/BLUEs for all the genotypes
in each trial.</p></dd>

<dt>std_residuals</dt>
<dd><p>A data.frame containing the standardized residuals for
the model with genotype as random component.</p></dd>

<dt>data</dt>
<dd><p>A data.frame containing the data used. If <code>remove_outliers</code>
is <code>TRUE</code>, data will have missing values for the outliers detected.</p></dd>

</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kwstat.github.io/agridat/" class="external-link">agridat</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/AparicioJohan/agriutilities" class="external-link">agriutilities</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">besag.met</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">besag.met</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="check_design_met.html">check_design_met</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">dat</span>,</span></span>
<span class="r-in"><span>  genotype <span class="op">=</span> <span class="st">"gen"</span>,</span></span>
<span class="r-in"><span>  trial <span class="op">=</span> <span class="st">"county"</span>,</span></span>
<span class="r-in"><span>  traits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"yield"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  rep <span class="op">=</span> <span class="st">"rep"</span>,</span></span>
<span class="r-in"><span>  block <span class="op">=</span> <span class="st">"block"</span>,</span></span>
<span class="r-in"><span>  col <span class="op">=</span> <span class="st">"col"</span>,</span></span>
<span class="r-in"><span>  row <span class="op">=</span> <span class="st">"row"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">single_trial_analysis</span><span class="op">(</span><span class="va">results</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary Fitted Models:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     trait  trial heritability        CV    VarGen    VarErr  design</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    &lt;char&gt; &lt;char&gt;        &lt;num&gt;     &lt;num&gt;     &lt;num&gt;     &lt;num&gt;  &lt;char&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:  yield     C1         0.73  6.022489  87.39848  82.86095 row_col</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:  yield     C2         0.37 17.104998  25.80684 108.68546 row_col</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:  yield     C3         0.64 12.357202  83.57907 118.55567 row_col</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:  yield     C4         0.41  8.179408  35.75568 136.21218 row_col</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:  yield     C5         0.80  7.037586 103.79822  66.97523 row_col</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:  yield     C6         0.49 16.632367  71.92232 207.53073 row_col</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Outliers Removed:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     trait  trial genotype    id outlier</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    &lt;char&gt; &lt;fctr&gt;   &lt;fctr&gt; &lt;int&gt;  &lt;lgcl&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:  yield     C1      G60    50    TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> First Predicted Values and Standard Errors (BLUEs/BLUPs):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---------------------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     trait genotype  trial    BLUEs  seBLUEs    BLUPs  seBLUPs         wt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    &lt;char&gt;   &lt;fctr&gt; &lt;fctr&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;      &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:  yield      G01     C1 141.4161 6.078858 143.5308 5.249771 0.02706176</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:  yield      G02     C1 157.8110 5.979708 155.8037 5.194547 0.02796663</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:  yield      G03     C1 127.3836 6.091534 133.0256 5.269999 0.02694925</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:  yield      G04     C1 154.8445 6.093866 153.8364 5.270427 0.02692863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:  yield      G05     C1 163.8950 6.132141 161.1831 5.271809 0.02659352</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:  yield      G06     C1 128.5168 6.087902 133.6857 5.247130 0.02698141</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Johan Aparicio, Alexia Bornhorst.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

