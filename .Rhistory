library(agriutilities)
library(agriutilities)
library(agriutilities)
library(agriutilities)
importFrom("stats", "na.omit")
library(agriutilities)
library(agriutilities)
library(agriutilities)
library(agriutilities)
library(agriutilities)
library(agriutilities)
library(agriutilities)
install.packages("pkgdown")
pkgdown::build_reference()
pkgdown::build_home()
pkgdown::build_articles()
pkgdown::build_news()
pkgdown::build_site
pkgdown::build_site()
pkgdown::build_home()
pkgdown::build_reference()
pkgdown::build_reference_index()
pkgdown::init_site()
pkgdown::build_home()
pkgdown::build_reference()
pkgdown::build_reference_index()
pkgdown::build_reference(lazy = F)
pkgdown::init_site()
pkgdown::build_home()
pkgdown::build_reference(lazy = F)
pkgdown::init_site()
pkgdown::build_home()
pkgdown::build_reference(lazy = F)
pkgdown::init_site()
pkgdown::build_home()
pkgdown::build_reference(lazy = F)
pkgdown::init_site()
pkgdown::build_home()
pkgdown::build_reference(lazy = F)
library(agriutilities)
library(agriutilities)
pkgdown::init_site()
pkgdown::build_home()
pkgdown::build_reference(lazy = F)
install.packages("C:/Users/japaricio/Downloads/descargar 2021/ASExtras4_1.0.zip", repos = NULL, type = "win.binary")
library(ASExtras4)
fa.asreml
fa.asreml %>% View()
library(tidyverse)
fa.asreml %>% View()
library(agriutilities)
usethis::use_package("plyr")
library(agriutilities)
devtools::load_all(".")
library(agriutilities)
library(agriutilities)
usethis::use_package("ggrepel")
library(agriutilities)
library(agriutilities)
print(summary(sqrt(1:100^2+1:100^2)))
print("fscore")
print("fscore \n")
library(agriutilities)
pkgdown::init_site()
pkgdown::build_home()
pkgdown::build_reference(lazy = F)
library(agriutilities)
pkgdown::build_reference_index()
pkgdown::init_site()
pkgdown::build_home()
pkgdown::build_reference(lazy = F)
library(agriutilities)
library(agriutilities)
library(agriutilities)
data("iris")
iris
library(agriutilities)
ggCor(iris)
ggCor(iris)
library(agriutilities)
library(agriutilities)
library(agriutilities)
ggCor(iris)
ggCor(iris, returnN = T)
ggCor(iris,colours = c("#db4437","white","#4285f4"), returnN = T)
pkgdown::init_site()
pkgdown::build_home()
pkgdown::build_reference(lazy = F)
# dat <- agridat::john.alpha
## fit model ---------------------------------------------------------------
## random genotype effect
# g.ran <- lme4::lmer(data  = dat, formula = yield ~ rep + (1|gen) + (1|rep:block))
# varG.pvalue(g.ran, "gen")
dat <- agridat::john.alpha
## fit model ---------------------------------------------------------------
# random genotype effect
g.ran <- lme4::lmer(data  = dat, formula = yield ~ rep + (1|gen) + (1|rep:block))
varG.pvalue(g.ran, "gen")
library(agriutilities)
cor(iris[,-5])
data(iris)
M = cor(iris[,-5])
covcor_heat(M, corr = T)
# Get lower triangle of the correlation matrix
get_lower_tri<-function(cormat){
cormat[upper.tri(cormat)] <- NA
return(cormat)
}
# Get upper triangle of the correlation matrix
get_upper_tri <- function(cormat){
cormat[lower.tri(cormat)]<- NA
return(cormat)
}
reorder_cormat <- function(cormat){
# Use correlation between variables as distance
dd <- as.dist((1-cormat)/2)
hc <- hclust(dd)
cormat <-cormat[hc$order, hc$order]
}
cormat <- reorder_cormat(matrix)
matrix = M
M
cormat <- reorder_cormat(matrix)
upper_tri <- get_upper_tri(matrix)
upper_tri
reshape2::melt(upper_tri, na.rm = TRUE)
reshape2::melt
usethis::use_package("reshape2")
library(agriutilities)
library(agriutilities)
data(iris)
M = cor(iris[,-5])
covcor_heat(M, corr = T)
library(agriutilities)
data(iris)
M = cor(iris[,-5])
covcor_heat(M, corr = T)
usethis::use_vignette("SpATS")
library(agriutilities)
library(SpATS)
dat <- agridat::john.alpha
dat$R <- as.factor(dat$row)
dat <- agridat::john.alpha
dat$R <- as.factor(dat$row)
dat
data(wheatdata)
wheatdata$R <- as.factor(wheatdata$row)
wheatdata$C <- as.factor(wheatdata$col)
# Without nested basis
m1 <- SpATS(response = "yield", spatial = ~ PSANOVA(col, row, nseg = c(10,20), nest.div = 2),
genotype = "geno", fixed = ~ colcode + rowcode, random = ~ R + C, data = wheatdata,
control =  list(tolerance = 1e-03))
library(agriutilities)
pkgdown::init_site()
pkgdown::build_home()
pkgdown::build_reference(lazy = F)
library(agriutilities)
library(SpATS)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>"
)
library(agriutilities)
library(SpATS)
data(wheatdata)
wheatdata$R <- as.factor(wheatdata$row)
wheatdata$C <- as.factor(wheatdata$col)
# Without nested basis
m1 <- SpATS(response = "yield", spatial = ~ PSANOVA(col, row, nseg = c(10,20), nest.div = 2),
genotype = "geno", fixed = ~ colcode + rowcode, random = ~ R + C, data = wheatdata,
control =  list(tolerance = 1e-03))
library(agriutilities)
library(SpATS)
library(agriutilities)
library(SpATS)
library(agriutilities)
pkgdown::init_site()
pkgdown::build_home()
pkgdown::build_reference(lazy = F)
pkgdown::build_articles_index()
pkgdown::build_articles()
library(agriutilities)
library(SpATS)
wheatdata[ 1 , "yield"]
pkgdown::init_site()
pkgdown::build_home()
pkgdown::build_reference(lazy = F)
pkgdown::build_articles_index()
pkgdown::init_site()
pkgdown::build_home()
pkgdown::build_reference(lazy = F)
pkgdown::build_articles()
pkgdown::init_site()
pkgdown::build_home()
pkgdown::build_reference(lazy = F)
pkgdown::build_articles()
pkgdown::build_articles_index()
pkgdown::init_site()
pkgdown::build_home()
pkgdown::build_reference(lazy = F)
pkgdown::build_articles()
pkgdown::build_articles_index()
pkgdown::build_articles()
pkgdown::build_articles_index()
pkgdown::init_site()
pkgdown::build_home()
pkgdown::build_reference(lazy = F)
pkgdown::build_articles()
pkgdown::build_articles_index()
pkgdown::init_site()
pkgdown::build_home()
pkgdown::build_reference(lazy = F)
pkgdown::build_reference_index()
pkgdown::build_articles(lazy = F)
pkgdown::build_articles_index()
pkgdown::init_site()
pkgdown::build_home()
pkgdown::build_reference(lazy = F)
pkgdown::build_reference_index()
pkgdown::build_articles(lazy = F)
pkgdown::build_articles_index()
pkgdown::init_site()
pkgdown::build_home()
pkgdown::build_reference(lazy = F)
pkgdown::build_reference_index()
pkgdown::build_articles(lazy = F)
pkgdown::build_articles_index()
pkgdown::init_site()
pkgdown::build_home()
pkgdown::build_reference(lazy = F)
pkgdown::build_reference_index()
pkgdown::build_articles(lazy = F)
pkgdown::build_articles_index()
pkgdown::init_site()
pkgdown::build_home()
pkgdown::build_reference(lazy = F)
pkgdown::build_reference_index()
pkgdown::build_articles(lazy = F)
pkgdown::build_articles_index()
pkgdown::init_site()
pkgdown::build_home()
pkgdown::build_reference(lazy = F)
pkgdown::build_reference_index()
pkgdown::build_articles(lazy = F)
pkgdown::build_articles_index()
pkgdown::init_site()
pkgdown::build_home()
pkgdown::build_reference(lazy = F)
pkgdown::build_reference_index()
pkgdown::build_articles(lazy = F)
pkgdown::build_articles_index()
usethis::use_package("data.table")
install.packages("qpdf")
usethis::use_package("SpATS")
library(agriutilities)
pkgdown::build_reference_index
library(agriutilities)
pkgdown::init_site()
pkgdown::build_home()
pkgdown::build_reference(lazy = F)
pkgdown::build_reference_index()
pkgdown::build_articles(lazy = F)
pkgdown::build_articles_index()
styler:::style_active_file()
styler:::style_active_file()
styler:::style_active_file()
library(agriutilities)
library(agriutilities)
library(agriutilities)
library(agridat)
data(besag.met)
dat <- besag.met
checkConection2(data = dat, genotype = "gen", trial = "county", response = "yield")
heatmap(conn)
data(besag.met)
dat <- besag.met
conn <- checkConection2(data = dat, genotype = "gen", trial = "county", response = "yield")
heatmap(conn)
conn
res <- factoextra::hcut(conn, k = 3, stand = FALSE)
factoextra::fviz_dend(
x = res,
rect = FALSE,
cex = 0.5,
lwd = 0.5,
main = "Dendrogram",
horiz = TRUE
)
conn
conn <- checkConection2(data = dat, genotype = "gen", trial = "county", response = "yield")
conn
library(agridat)
data(besag.met)
dat <- besag.met
checkConection(data = dat, genotype = "gen", trial = "county", response = "yield", all = T)
checkConection(data = dat, genotype = "gen", trial = "county", response = "yield", all = F)
library(agridat)
data(besag.met)
dat <- besag.met
checkConection2(data = dat, genotype = "gen", trial = "county", response = "yield")
data = dat
genotype = "gen"
trial = "county"
response = "yield"
response = "yield"
data %>%
dplyr::filter(!is.na(.data[[response]])) %>%
dplyr::select(.data[[genotype]], .data[[trial]]) %>%
unique.data.frame() %>%
dplyr::mutate(value = 1) %>%
tidyr::spread(.data[[trial]], value = value)
library(tidyverse)
data %>%
dplyr::filter(!is.na(.data[[response]])) %>%
dplyr::select(.data[[genotype]], .data[[trial]]) %>%
unique.data.frame() %>%
dplyr::mutate(value = 1) %>%
tidyr::spread(.data[[trial]], value = value) %>%
tibble::column_to_rownames(genotype)
tmp_data <- data %>%
dplyr::filter(!is.na(.data[[response]])) %>%
dplyr::select(.data[[genotype]], .data[[trial]]) %>%
unique.data.frame() %>%
dplyr::mutate(value = 1) %>%
tidyr::spread(.data[[trial]], value = value) %>%
tibble::column_to_rownames(genotype) %>%
as.matrix()
tmp_data
dat$gen
dat[dat$gen == "G02", "yield"]
dat[dat$gen == "G02", "yield"] <- 0
data = dat
data %>%
dplyr::filter(!is.na(.data[[response]])) %>%
dplyr::select(.data[[genotype]], .data[[trial]]) %>%
unique.data.frame() %>%
dplyr::mutate(value = 1) %>%
tidyr::spread(.data[[trial]], value = value) %>%
tibble::column_to_rownames(genotype) %>%
as.matrix()
data(besag.met)
dat <- besag.met
dat[dat$gen == "G02", "yield"] <- 0
data = dat
dat
dat[dat$gen == "G02", "yield"] <- NA
data = dat
data %>%
dplyr::filter(!is.na(.data[[response]])) %>%
dplyr::select(.data[[genotype]], .data[[trial]]) %>%
unique.data.frame() %>%
dplyr::mutate(value = 1) %>%
tidyr::spread(.data[[trial]], value = value) %>%
tibble::column_to_rownames(genotype) %>%
as.matrix()
dat[dat$gen == "G02", "yield"]
dat[dat$gen == "G02", "yield"] %>% length()
dat[dat$gen == "G02", "yield"] <- c(1:5)
dat[dat$gen == "G02", "yield"] <- c(1:5, NA)
data(besag.met)
dat <- besag.met
dat[dat$gen == "G02", "yield"] <- c(1:5, NA)
dat
dat[dat$gen == "G02", "yield"]
data = dat
data %>%
dplyr::filter(!is.na(.data[[response]])) %>%
dplyr::select(.data[[genotype]], .data[[trial]]) %>%
unique.data.frame() %>%
dplyr::mutate(value = 1) %>%
tidyr::spread(.data[[trial]], value = value) %>%
tibble::column_to_rownames(genotype) %>%
as.matrix()
library(agridat)
data(besag.met)
dat <- besag.met
dat[dat$gen == "G02", "yield"] <- c(1:5, rep(NA, 13))
dat[dat$gen == "G02", "yield"]
data = dat
data %>%
dplyr::filter(!is.na(.data[[response]])) %>%
dplyr::select(.data[[genotype]], .data[[trial]]) %>%
unique.data.frame() %>%
dplyr::mutate(value = 1) %>%
tidyr::spread(.data[[trial]], value = value) %>%
tibble::column_to_rownames(genotype) %>%
as.matrix()
tmp_data <- data %>%
dplyr::filter(!is.na(.data[[response]])) %>%
dplyr::select(.data[[genotype]], .data[[trial]]) %>%
unique.data.frame() %>%
dplyr::mutate(value = 1) %>%
tidyr::spread(.data[[trial]], value = value) %>%
tibble::column_to_rownames(genotype) %>%
as.matrix()
tmp_data
is.na(tmp_data)
tmp_data[is.na(tmp_data)] <- 0
tmp_data
tmp_data * t(tmp_data)
t(tmp_data)
tmp_data %*% t(tmp_data)
t(tmp_data) %*% tmp_data
checkConection2(data = dat, genotype = "gen", trial = "county", response = "yield")
t(tmp_data) %*% tmp_data
tmp_data %*% t(tmp_data)
library(agriutilities)
data(besag.met)
dat <- besag.met
conn <- checkConection2(data = dat, genotype = "gen", trial = "county", response = "yield")
conn
devtools::load_all(".")
library(agriutilities)
usethis::use_package("tibble")
usethis::use_package("rlang")
usethis::use_package("lucid")
usethis::use_package("SpATS")
usethis::use_package("lattice")
styler:::style_active_file()
library(asreml)
ma <- asreml(travel~1, random=~Rail, data=Rail)
data(Rail)
require("nlme")
data(Rail)
ma <- asreml(travel~1, random=~Rail, data=Rail)
vc(ma)
library(lucid)
ma <- asreml(travel~1, random=~Rail, data=Rail)
vc(ma)
summary(ma)$varcomp
data.frame(effect = summary(ma)$varcomp, summary(ma)$varcomp)
data.frame(effect = rownames(summary(ma)$varcomp), summary(ma)$varcomp)
model = ma
vars <- summary(model)$varcomp
vars
vars <- data.frame(effect = rownames(vars), vars, check.names = FALSE)
vars
lucid::vc(ma)
lucid::vc(ma) %>% class
install.packages("roxygen2")
library(agriutilities)
library(agriutilities)
pkgdown::build_site()
